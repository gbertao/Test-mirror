{
  "comments": [
    {
      "key": {
        "uuid": "c061795b_ea99b0ba",
        "filename": "public/clatd.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2019-05-02T17:35:28Z",
      "side": 1,
      "message": "Rather than allow clad to relabel objects, can we allow it to operate directly on the object received from netd? e.g. change this line to:\nallow clatd self:{ packet_socket rawip_socket } create_socket_perms_no_ioctl;\nallow clatd netd:tun_socket create_socket_perms_no_ioctl;",
      "range": {
        "startLine": 39,
        "startChar": 46,
        "endLine": 39,
        "endChar": 56
      },
      "revId": "972a7ad37297c4cc727294c71d8ca543b02fc801",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5fe444f5_f4137222",
        "filename": "public/clatd.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2019-05-02T19:14:39Z",
      "side": 1,
      "message": "I\u0027ll give this a try... but I was getting audit denials on the relabel... are those perhaps non-final? and if I give it the right to use them even though not the right to relabel them (I guess I\u0027ll need dontaudit for the relabel?) then things will work?\n\nI\u0027ll see.",
      "parentUuid": "c061795b_ea99b0ba",
      "range": {
        "startLine": 39,
        "startChar": 46,
        "endLine": 39,
        "endChar": 56
      },
      "revId": "972a7ad37297c4cc727294c71d8ca543b02fc801",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "702f27ee_6440399b",
        "filename": "public/clatd.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2019-05-04T18:18:45Z",
      "side": 1,
      "message": "It took a while to track this down.\nThe relabelfrom/relabelto are actually triggered as part of the ioctl(tundev,TUNSETIFF) syscall.\nInitially I had this still happening in clatd, which was triggering the netd-\u003eclatd relabel.\nThis was actually a temporary state of affairs, and I do indeed need the TUNSETIFF and thus device ifindex assignment to happen in netd.  As such the relabel happens in netd (and since it\u0027s netd-\u003enetd, it\u0027s not even a relabel) and thus the above rules are once the code is fully transitioned, not actually needed.  I\u0027ll remove them from this commit.",
      "parentUuid": "5fe444f5_f4137222",
      "range": {
        "startLine": 39,
        "startChar": 46,
        "endLine": 39,
        "endChar": 56
      },
      "revId": "972a7ad37297c4cc727294c71d8ca543b02fc801",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}