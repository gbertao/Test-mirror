{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "d05045ee_fdc5334b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-10-12T18:35:44Z",
      "side": 1,
      "message": "Is there some place I can look to get an explanation of why Netlink should be intercepted?",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 32
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4745ea8f_90071072",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T18:44:41Z",
      "side": 1,
      "message": "Design (why): go/aae-tcu-wifi\nDesign (how): go/wificond-nl-interception\n\nTL;DR: we\u0027re looking to remote Wi-Fi hardware. Netlink is /the/ standard interface to communicate with Wi-Fi cards so we took it as the remote API (and proved it working pretty well).",
      "parentUuid": "d05045ee_fdc5334b",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 32
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "523008df_513fd221",
        "filename": "/COMMIT_MSG",
        "patchSetId": 5
      },
      "lineNbr": 9,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-10-12T18:35:44Z",
      "side": 1,
      "message": "don\u0027t you mean off? Or perhaps just say \"work in enforcing mode\"",
      "range": {
        "startLine": 9,
        "startChar": 25,
        "endLine": 9,
        "endChar": 54
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bdf69183_5703d82b",
        "filename": "private/service_contexts",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2021-10-12T02:42:29Z",
      "side": 1,
      "message": "since we already have hardware/interfaces/net, could we put this there?\n\ne.g.:\n\nandroid.hardware.net.interceptor.IInterceptor. WDYT?",
      "range": {
        "startLine": 26,
        "startChar": 8,
        "endLine": 26,
        "endChar": 10
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6c32fd0_aa43fc87",
        "filename": "private/service_contexts",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T17:29:06Z",
      "side": 1,
      "message": "Do we? I don\u0027t see such a folder nor any HAL in such a namespace.\n\nHaving said that, I do like suggested namespace.",
      "parentUuid": "bdf69183_5703d82b",
      "range": {
        "startLine": 26,
        "startChar": 8,
        "endLine": 26,
        "endChar": 10
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "457803a3_7e3e6bc7",
        "filename": "private/service_contexts",
        "patchSetId": 5
      },
      "lineNbr": 26,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2021-10-12T17:58:33Z",
      "side": 1,
      "message": "Oh - oops, I was looking at system/hardware/interfaces/net/. Still maybe we can start something similar in hardware/interfaces?",
      "parentUuid": "e6c32fd0_aa43fc87",
      "range": {
        "startLine": 26,
        "startChar": 8,
        "endLine": 26,
        "endChar": 10
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b8765ca9_2b159a87",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2021-10-12T02:42:29Z",
      "side": 1,
      "message": "is this a new process serving this? (asking because I don\u0027t see we\u0027re adding this domain to any executable)",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "836bb8c1_af0f9ad7",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T17:29:06Z",
      "side": 1,
      "message": "I don\u0027t fully understand this question. Chris added this domain in `hal_wifi_nlinterceptor.te:6`.",
      "parentUuid": "b8765ca9_2b159a87",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b9083e4b_57947367",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2021-10-12T17:58:33Z",
      "side": 1,
      "message": "This defines an attribute (actually a couple of different attributes), but it doesn\u0027t apply them to any domain. What I don\u0027t see here (that you should need) is something like this:\n\n# in \u003csomething\u003e.te\nhal_server_domain(\u003csomething\u003e, hal_wifi_nlinterceptor)\n\n# in file_contexts\n/vendor/bin/hw/blahblahblah-service ...\u003csomething\u003e_exec...",
      "parentUuid": "836bb8c1_af0f9ad7",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f25fad97_29cd2354",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T18:06:07Z",
      "side": 1,
      "message": "There\u0027s no default implementation of this hal, but device (or application?) specific. Example for Cuttlefish:\n\nhttps://googleplex-android-review.git.corp.google.com/c/device/google/cuttlefish/+/15820010/13/shared/sepolicy/vendor/hal_wifi_nlinterceptor_cf.te\n\nHow is this related to net_admin capability?",
      "parentUuid": "b9083e4b_57947367",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8221a230_5accbac0",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1120458
      },
      "writtenOn": "2021-10-12T18:31:14Z",
      "side": 1,
      "message": "Well, any service can mark themselves as one of these attributes and get net_admin. It would be nice if we could scope this down to a specific binary (if it\u0027s generic), but if we only have device-specific implementations, we might not be able to.\n\nwill the CF CL move to AOSP?",
      "parentUuid": "f25fad97_29cd2354",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7ce35e87_1cf0263f",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T18:44:41Z",
      "side": 1,
      "message": "Even if CF implementation moves to AOSP, device-specific implementations will be different.",
      "parentUuid": "8221a230_5accbac0",
      "range": {
        "startLine": 13,
        "startChar": 37,
        "endLine": 13,
        "endChar": 46
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ada8c0a2_92ceedcf",
        "filename": "public/hal_wifi_nlinterceptor.te",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-10-12T18:35:44Z",
      "side": 1,
      "message": "This seems incorrect. You\u0027re granting this HAL access to over 50 socket types (and all future ones), and granting it CAP_NET_ADMIN, which is going to result in it having access to huge amounts of kernel attack surface. This seems unnecessarily overprivileged, especially considering that most of these socket types are not even used anywhere on Android. Perhaps it would be best for you to provide an explanation for each socket type, why this HAL needs access to it:\nsocket tcp_socket udp_socket rawip_socket netlink_socket packet_socket key_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket sctp_socket icmp_socket ax25_socket ipx_socket netrom_socket atmpvc_socket x25_socket rose_socket decnet_socket atmsvc_socket rds_socket irda_socket pppox_socket llc_socket can_socket tipc_socket bluetooth_socket iucv_socket rxrpc_socket isdn_socket phonet_socket ieee802154_socket caif_socket alg_socket nfc_socket vsock_socket kcm_socket qipcrtr_socket smc_socket.",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 80
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "210e1e2b_4ada8baa",
        "filename": "public/hal_wifi_nlinterceptor.te",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1135107
      },
      "writtenOn": "2021-10-12T18:44:41Z",
      "side": 1,
      "message": "Sg. Something along the lines of http://ag/c/device/google/cuttlefish/+/15820010/1/shared/sepolicy/vendor/cf-nl-interceptor.te ?\n\nWould create_socket_perms_no_ioctl be still okay or Chris needs to list every individual operation as well?",
      "parentUuid": "ada8c0a2_92ceedcf",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 80
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2da94c3d_692a345e",
        "filename": "public/hal_wifi_nlinterceptor.te",
        "patchSetId": 5
      },
      "lineNbr": 7,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-10-12T19:59:13Z",
      "side": 1,
      "message": "\u003e Sg. Something along the lines of http://ag/c/device/google/cuttlefish/+/15820010/1/shared/sepolicy/vendor/cf-nl-interceptor.te ?\n\nThat seems better, but it\u0027s still including a bunch of stuff that doesn\u0027t appear to be related to wifi. I would still like to see an explanation for why each socket type is needed.\n\u003e \n\u003e Would create_socket_perms_no_ioctl be still okay or Chris needs to list every individual operation as well?\n\nUsing the create_socket_perms_no_ioctl macro is fine.",
      "parentUuid": "210e1e2b_4ada8baa",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 80
      },
      "revId": "0470db80df4390c4c10444722ce055d21e6c130c",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}