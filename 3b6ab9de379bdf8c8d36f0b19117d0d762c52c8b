{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "b9d6935a_9206644b",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-01-13T10:02:36Z",
      "side": 1,
      "message": "It would probably be better to use hal_automotive_socket_exemption here, as below; this also seems like it shouldn\u0027t happen on non-auto builds.\n\nBut it\u0027s not clear to me that the exemption should be extended to this neverallow. I\u0027ll leave it to @jeffv@google.com to decide.",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9917eb6c_d9fa0ed8",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-01-13T11:07:09Z",
      "side": 1,
      "message": "Let\u0027s ask the Core networking team if this is acceptable. Generally only core networking code should be allowed to modify network settings. This appears to break that assumption.\n\n+lorenzo@ and +maze@ to comment.",
      "parentUuid": "b9d6935a_9206644b",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e38c131b_9bcb3712",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2023-01-13T12:06:37Z",
      "side": 1,
      "message": "Yeah, I\u0027m not following why this is a good idea to do - *especially* so in non-auto-specific logic...\n\nWhat specific setsockopt(s) requires net_raw?\nIs there a design doc / discussion for this somewhere?\nI tried following the link to the bug, but that doesn\u0027t seem useful...\nWhy can\u0027t this use normal Android access permission model for binding to networks?\n\nAlso why does this also allow net_admin?\n(does this mean a separate neverallow for net_admin should be added?)",
      "parentUuid": "9917eb6c_d9fa0ed8",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02acc07e_f7ea4381",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1219061
      },
      "writtenOn": "2023-01-13T18:08:49Z",
      "side": 1,
      "message": "Yes, we only need net_raw, I can add a never allow rule for net_admin.\n\nThe reason we need this is for this CL: ag/20964735 to work. Specifically, we use the grpc\u0027s SetSocketMutator function. We need to use setsockopt(SO_BINDTODEVICE) to bind the socket fd to a specific interface.",
      "parentUuid": "e38c131b_9bcb3712",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2913926b_f246420e",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2023-01-13T18:25:03Z",
      "side": 1,
      "message": "Hah, so I happened to learn about this yesterday, due to a forward porting bug of a patch I wrote for prodkernel being incorrectly applied to 5.15, but:\n\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id\u003dc427bfec18f2190b8f4718785ee8ed2db4f84ee6\n\nnet: core: enable SO_BINDTODEVICE for non-root users\n\nWhich is in Linux ~5.6..5.7 so in Pixel 6+\n\n---\n\nNow a separate question is whether we\u0027re actually OK with this change for Android... since it might break some network binding assumptions.",
      "parentUuid": "02acc07e_f7ea4381",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9644254d_6bbff9fe",
        "filename": "public/hal_neverallows.te",
        "patchSetId": 1
      },
      "lineNbr": 7,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2023-01-13T18:29:32Z",
      "side": 1,
      "message": "btw. I expect you should fix grpc to use android ndk network socket binding primitives.",
      "parentUuid": "2913926b_f246420e",
      "range": {
        "startLine": 7,
        "startChar": 3,
        "endLine": 7,
        "endChar": 26
      },
      "revId": "3b6ab9de379bdf8c8d36f0b19117d0d762c52c8b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}