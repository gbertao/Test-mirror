{
  "comments": [
    {
      "key": {
        "uuid": "5ae139e3_47fdc8f6",
        "filename": "private/flags_health_check.te",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2018-10-26T03:31:47Z",
      "side": 1,
      "message": "This indicates that the binary is executed by init, usually via a *.rc file. I don\u0027t see a *.rc file as part of the changes associated with this topic. Is it in a different change or something coming later?",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "372e6e55_81b16858",
        "filename": "private/flags_health_check.te",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 1367962
      },
      "writtenOn": "2018-10-26T23:03:51Z",
      "side": 1,
      "message": "Yes, this binary is going to be executed in rootdir/init.rc. It\u0027s going to be included in a cl coming later.",
      "parentUuid": "5ae139e3_47fdc8f6",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1e61bc50_4388dede",
        "filename": "public/property.te",
        "patchSetId": 1
      },
      "lineNbr": 270,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2018-10-26T03:31:47Z",
      "side": 1,
      "message": "since the intended purpose of this neverallow rule is to protect the flags_health_check domain, we normally try to keep it close to flags_health_check.te file. Can you move it there and perhaps document why it\u0027s important that nobody other than flags_health_check be able to set this flag?",
      "range": {
        "startLine": 264,
        "startChar": 0,
        "endLine": 270,
        "endChar": 25
      },
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f27ec411_79c9cf57",
        "filename": "public/property.te",
        "patchSetId": 1
      },
      "lineNbr": 270,
      "author": {
        "id": 1367962
      },
      "writtenOn": "2018-10-26T23:03:51Z",
      "side": 1,
      "message": "Got it, I\u0027ll move it.",
      "parentUuid": "1e61bc50_4388dede",
      "range": {
        "startLine": 264,
        "startChar": 0,
        "endLine": 270,
        "endChar": 25
      },
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "152eb808_f9ca5e0f",
        "filename": "public/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2018-10-26T03:31:47Z",
      "side": 1,
      "message": "What\u0027s the expected behavior when the adb shell user executes /system/bin/flags_health_check ? When this binary is executed by the shell user, it will run in the \"shell\" SELinux domain (not the \"flags_health_check\" domain). I\u0027m not sure this is going to do anything useful.",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4dc272bb_553e1ddd",
        "filename": "public/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1367962
      },
      "writtenOn": "2018-10-26T23:03:51Z",
      "side": 1,
      "message": "I\u0027m planning to add some CTS tests for the binary. What the CTS tests do is: setting some properties --\u003e running the cmd: ./system/bin/flags_health_check --\u003e assert if properties have the expected changes. That\u0027s why I add this line here -- to allow shell execute this binary.\nBut please let me know if it\u0027s not the right way to achieve it or you have other security concerns.",
      "parentUuid": "152eb808_f9ca5e0f",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fb1d5d78_273f4733",
        "filename": "public/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2018-10-26T23:13:17Z",
      "side": 1,
      "message": "\u003e I\u0027m planning to add some CTS tests for the binary. What the CTS tests do is: setting some properties --\u003e running the cmd: ./system/bin/flags_health_check --\u003e assert if properties have the expected changes. That\u0027s why I add this line here -- to allow shell execute this binary.\n\u003e But please let me know if it\u0027s not the right way to achieve it or you have other security concerns.\n\nAs currently written, when the shell user executes /system/bin/flags_health_check, the executable will be run in the shell domain. And the shell domain, per the neverallow assertion you added, cannot set these properties. Only the domain flags_health_check, which is entered when init executes /system/bin/flags_health_check, can set these flags.\n\nIf the intention is that this property (and future properties) are going to be exposed to the untrusted shell user, then we have to assume that someone can inject invalid or illegal values here, which raises the security requirements quite a bit.\n\nI would recommend you delete this line until you have the tests written.",
      "parentUuid": "4dc272bb_553e1ddd",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0bf8fe2d_9eb166b7",
        "filename": "public/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 53,
      "author": {
        "id": 1367962
      },
      "writtenOn": "2018-11-01T18:44:19Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fb1d5d78_273f4733",
      "revId": "250bc1bc9ecbfba299ad6dbef06206c81e8408f4",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}