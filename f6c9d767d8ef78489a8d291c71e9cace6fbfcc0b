{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1b3bf663_fb4f3880",
        "filename": "private/domain.te",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-20T17:13:48Z",
      "side": 1,
      "message": "Why write not read? I though entropy was sent from the daemon to the domain?",
      "range": {
        "startLine": 125,
        "startChar": 42,
        "endLine": 125,
        "endChar": 47
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b8da1c4d_37bd390a",
        "filename": "private/domain.te",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1060907
      },
      "writtenOn": "2022-09-21T01:49:46Z",
      "side": 1,
      "message": "Switching this from write to read results in denials like this:\n\n```\n09-21 01:31:05.227   249   249 I auditd  : type\u003d1400 audit(0.0:4): avc: denied { read } for comm\u003d\"prng_seeder\" path\u003d\"socket:[14763]\" dev\u003d\"sockfs\" ino\u003d14763 scontext\u003du:r:prng_seeder:s0 tcontext\u003du:object_r:prng_seeder_socket:s0 tclass\u003dunix_stream_socket permissive\u003d0\n09-21 01:31:05.227   249   249 W prng_seeder: type\u003d1400 audit(0.0:4): avc: denied { read } for path\u003d\"socket:[14763]\" dev\u003d\"sockfs\" ino\u003d14763 scontext\u003du:r:prng_seeder:s0 tcontext\u003du:object_r:prng_seeder_socket:s0 tclass\u003dunix_stream_socket permissive\u003d0\n```",
      "parentUuid": "1b3bf663_fb4f3880",
      "range": {
        "startLine": 125,
        "startChar": 42,
        "endLine": 125,
        "endChar": 47
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0a8ecb3_8c4f9e2f",
        "filename": "private/domain.te",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-21T08:56:06Z",
      "side": 1,
      "message": "That change couldn\u0027t produce those denials.\n(They\u0027re saying prng_seeder couldn\u0027t read the socket; the rule here is saying that the client can read/write the socket. Also, the denials are showing up on unix_stream_socket, while this rule affects sock_file.)\n\nBut the other change below could.\n\nTBH I\u0027m confused by how this works at all, since I can\u0027t see where clients are allowed to read.\n\nI think you should probably go back to:\nunix_socket_connect(domain, prng_seeder, prng_seeder_socket)\n\nWhich is equivalent to these two lines.",
      "parentUuid": "b8da1c4d_37bd390a",
      "range": {
        "startLine": 125,
        "startChar": 42,
        "endLine": 125,
        "endChar": 47
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5cc318a2_44b78e67",
        "filename": "private/domain.te",
        "patchSetId": 8
      },
      "lineNbr": 125,
      "author": {
        "id": 1334152
      },
      "writtenOn": "2022-09-21T08:56:43Z",
      "side": 1,
      "message": "+1 and seems to be consistent with other socket sepolicy... For whatever reasons, selinux checks for write permission on the socket entry in the filesystem when a process tries to connect.",
      "parentUuid": "b8da1c4d_37bd390a",
      "range": {
        "startLine": 125,
        "startChar": 42,
        "endLine": 125,
        "endChar": 47
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "19211e2d_3002fa26",
        "filename": "private/file.te",
        "patchSetId": 8
      },
      "lineNbr": 126,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-20T17:13:48Z",
      "side": 1,
      "message": "nit: Mention subject is needed for connectto and object for read/write?",
      "range": {
        "startLine": 125,
        "startChar": 52,
        "endLine": 126,
        "endChar": 22
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5f5e204f_857bd9dc",
        "filename": "private/file.te",
        "patchSetId": 8
      },
      "lineNbr": 126,
      "author": {
        "id": 1060907
      },
      "writtenOn": "2022-09-21T01:49:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "19211e2d_3002fa26",
      "range": {
        "startLine": 125,
        "startChar": 52,
        "endLine": 126,
        "endChar": 22
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8a3a5323_6c1a47e4",
        "filename": "private/init.te",
        "patchSetId": 8
      },
      "lineNbr": 113,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-20T17:13:48Z",
      "side": 1,
      "message": "nit: connectto is redundant here (and not covered by the comment), since domain includes init.",
      "range": {
        "startLine": 113,
        "startChar": 70,
        "endLine": 113,
        "endChar": 79
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "183e2c92_fe3dd675",
        "filename": "private/init.te",
        "patchSetId": 8
      },
      "lineNbr": 113,
      "author": {
        "id": 1060907
      },
      "writtenOn": "2022-09-21T01:49:46Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8a3a5323_6c1a47e4",
      "range": {
        "startLine": 113,
        "startChar": 70,
        "endLine": 113,
        "endChar": 79
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3a7f8768_42d66df9",
        "filename": "private/init.te",
        "patchSetId": 8
      },
      "lineNbr": 113,
      "author": {
        "id": 1334152
      },
      "writtenOn": "2022-09-21T08:56:43Z",
      "side": 1,
      "message": "Ah thanks! (Aside: we need to remove the transitive dependency on libcrypto that init somehow gained in the last cycle, at which point it won\u0027t need connecto anyway).",
      "parentUuid": "183e2c92_fe3dd675",
      "range": {
        "startLine": 113,
        "startChar": 70,
        "endLine": 113,
        "endChar": 79
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f8759944_de446e05",
        "filename": "private/prng_seeder.te",
        "patchSetId": 8
      },
      "lineNbr": 12,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-20T17:13:48Z",
      "side": 1,
      "message": "Why do you need read?",
      "range": {
        "startLine": 12,
        "startChar": 58,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "07b5a9f4_bf20877e",
        "filename": "private/prng_seeder.te",
        "patchSetId": 8
      },
      "lineNbr": 12,
      "author": {
        "id": 1060907
      },
      "writtenOn": "2022-09-21T01:49:46Z",
      "side": 1,
      "message": "I get these denials without:\n\n```\n09-21 01:31:05.227   249   249 I auditd  : type\u003d1400 audit(0.0:4): avc: denied { read } for comm\u003d\"prng_seeder\" path\u003d\"socket:[14763]\" dev\u003d\"sockfs\" ino\u003d14763 scontext\u003du:r:prng_seeder:s0 tcontext\u003du:object_r:prng_seeder_socket:s0 tclass\u003dunix_stream_socket permissive\u003d0\n09-21 01:31:05.227   249   249 W prng_seeder: type\u003d1400 audit(0.0:4): avc: denied { read } for path\u003d\"socket:[14763]\" dev\u003d\"sockfs\" ino\u003d14763 scontext\u003du:r:prng_seeder:s0 tcontext\u003du:object_r:prng_seeder_socket:s0 tclass\u003dunix_stream_socket permissive\u003d0\n```",
      "parentUuid": "f8759944_de446e05",
      "range": {
        "startLine": 12,
        "startChar": 58,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ff5b67d2_70411853",
        "filename": "private/prng_seeder.te",
        "patchSetId": 8
      },
      "lineNbr": 12,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-09-21T08:56:06Z",
      "side": 1,
      "message": "OK, so you are reading. But why? It\u0027s not mentioned in the comment at #2.",
      "parentUuid": "07b5a9f4_bf20877e",
      "range": {
        "startLine": 12,
        "startChar": 58,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "deaea7e2_0649657d",
        "filename": "private/prng_seeder.te",
        "patchSetId": 8
      },
      "lineNbr": 12,
      "author": {
        "id": 1334152
      },
      "writtenOn": "2022-09-21T08:56:43Z",
      "side": 1,
      "message": "Based on system call traces I assume this is because the Rust async stuff is doing a select loop in the background.",
      "parentUuid": "07b5a9f4_bf20877e",
      "range": {
        "startLine": 12,
        "startChar": 58,
        "endLine": 12,
        "endChar": 62
      },
      "revId": "f6c9d767d8ef78489a8d291c71e9cace6fbfcc0b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}