{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "38131958_6b2f09b0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-08-15T15:52:47Z",
      "side": 1,
      "message": "Much breakage, but I\u0027m afraid I have no idea why.",
      "revId": "15e4f478d3ba573b722a04175c8a6960fc972b65",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "411786c4_91be48f9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1929300
      },
      "writtenOn": "2022-08-15T16:41:11Z",
      "side": 1,
      "message": "Looking at the test failures, it appears some of the vendor allowrules are missing. For example, in this failure\nhttps://android-build.googleplex.com/builds/tests/view?invocationId\u003dI09600010081004355\u0026testResultId\u003dTR82128203814767539\nI can see the following rules among the missing ones\nhttps://cs.android.com/android/platform/superproject/+/master:device/google/cuttlefish/shared/sepolicy/vendor/shell.te\nThose rules are vendor specific, in this case cuttlefish.\n\nI think the issue is that the precompiled sepolicy I am using as the baseline for the testSeamendcAgainstPrecompiledPolicies test is missing rules. The sepolicy is defined here\nhttps://cs.android.com/android/platform/superproject/+/master:system/sepolicy/Android.bp;l\u003d915;drc\u003d143988dedb15a3c397785c88efc8d4a0d13d9374\n\nThe vendor_sepolicy.cil dependency is limited to AOSP and it does not contain all the rules from device/google/cuttlefish. Is there a way I can add a dependency to the *real* device policy from within AOSP?",
      "parentUuid": "38131958_6b2f09b0",
      "revId": "15e4f478d3ba573b722a04175c8a6960fc972b65",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "877e6ce2_4bd14a3c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1061164
      },
      "writtenOn": "2022-08-16T12:34:10Z",
      "side": 1,
      "message": "Not sure if that\u0027s possible. AOSP is really just about AOSP. The way this presubmit is being setup for example doesn\u0027t distinguish between devices. Also, CTS test should validate AOSP implementation. There are devices in the wild that must pass CTS that aren\u0027t similar to internal phone devices for example.",
      "parentUuid": "411786c4_91be48f9",
      "revId": "15e4f478d3ba573b722a04175c8a6960fc972b65",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "26f7b4b4_10ed4646",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-08-16T12:40:57Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "877e6ce2_4bd14a3c",
      "revId": "15e4f478d3ba573b722a04175c8a6960fc972b65",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "062c5570_bafa15c4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1929300
      },
      "writtenOn": "2022-08-16T14:07:51Z",
      "side": 1,
      "message": "Talking about the failures with Jeff, it appears the issue comes from the fact that in the SeamendcHostTest I am comparing the amended policy against the sepolicy loaded by the kernel\nhttps://cs.android.com/android/platform/superproject/+/master:cts/hostsidetests/security/src/android/security/cts/SeamendcHostTest.java;l\u003d74;drc\u003d93e41165bcc022d2c863bd7ab5a30c1d7cc966dc\nThe problem with that policy is that it is too difficult to predict what goes inside the policy exactly, because it depends on many factors like device partitions, build targets, whether it is a mixed build, etc.\n\nWhat Jeff recommended instead is to pull the CIL files from the device and try to replicate mimic as much as possible the steps selinux.cpp takes when following the compilation path\nhttps://cs.android.com/android/platform/superproject/+/master:system/core/init/selinux.cpp;l\u003d370-494;drc\u003d2d579af880afae96239c80765b11c7dbc2c1b264\nI am disabling the tests in aosp/2188075 and will rewrite them following this approach.\n\n(Adding Jeff to cc to make sure I did not misunderstand)",
      "parentUuid": "26f7b4b4_10ed4646",
      "revId": "15e4f478d3ba573b722a04175c8a6960fc972b65",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}