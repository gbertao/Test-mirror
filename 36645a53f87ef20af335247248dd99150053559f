{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "0f029647_ef86065f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 7,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-10-06T09:14:53Z",
      "side": 1,
      "message": "There\u0027s no explanation here or on the bug of why this access is happening, or why we should allow it (as opposed to, say, dontaudit -ing it).",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 7,
        "endChar": 52
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5128e293_96dce5d5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 7,
      "author": {
        "id": 1895890
      },
      "writtenOn": "2022-10-06T21:13:30Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "0f029647_ef86065f",
      "range": {
        "startLine": 6,
        "startChar": 0,
        "endLine": 7,
        "endChar": 52
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "44574fc1_9e9d300a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-10-06T03:05:52Z",
      "side": 1,
      "message": "+Alan as Jeff seems to be OOO.",
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a76dabb0_3976f315",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-10-06T09:14:53Z",
      "side": 1,
      "message": "But why? (The code tells me that\u0027s what you\u0027re doing, the comment should tell me why this is needed.)\nThat seems like a Treble violation (not that I\u0027m a Treble expert).\nWhich vendor apex do you need access to?",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "127803fd_c4854394",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1895890
      },
      "writtenOn": "2022-10-06T21:13:30Z",
      "side": 1,
      "message": "Sorry for lack of context. I\u0027ve updated description. I don\u0027t think it\u0027s a treble violation. This became an issue after introducing widevine apex.",
      "parentUuid": "a76dabb0_3976f315",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ee1aa2f4_6db392b1",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1561651
      },
      "writtenOn": "2022-10-07T04:57:20Z",
      "side": 1,
      "message": "+1 on Alan\u0027s comment. Could you be more precise on which file exactly is accessed? If you can share the corresponding denial, that would help. Thanks.",
      "parentUuid": "127803fd_c4854394",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d17e476_e60c7716",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2022-10-07T07:49:06Z",
      "side": 1,
      "message": "\u003e I don\u0027t think it\u0027s a treble violation.\n\nCan you be specific about why it\u0027s not a treble violation for a system process to directly access files in /vendor? We don\u0027t grant exceptions just because someone added a violation within an implementation.",
      "parentUuid": "ee1aa2f4_6db392b1",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5aa29a0b_15f06034",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-10-07T10:52:50Z",
      "side": 1,
      "message": "I support Deyao in that this isn\u0027t a Treble violation (and I am from Treble :)). The Play app doesn\u0027t do anything specific to SoC with these vendor APEXes. It treats them just like the system-side APEXes. This new access is needed simply because the vendor APEXes are about to be updatable via Play.\n\nNote that we even have \"allow { appdomain -ephemeral_app -sdk_sandbox } vendor_app_file:file execute;\" for APKs.",
      "parentUuid": "6d17e476_e60c7716",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e30f1491_81f70e75",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-10-07T10:56:52Z",
      "side": 1,
      "message": "But we\u0027re granting access here to all of priv_app, not just Play.",
      "parentUuid": "5aa29a0b_15f06034",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0a9a4ab5_08f2ab6e",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-10-07T11:02:11Z",
      "side": 1,
      "message": "I know, but we don\u0027t have a label exclusive for Play (or other OEM-owned installers). I am not saying that it\u0027s okay, but that issue shouldn\u0027t be the reason for blocking this change, IMO.\n\nAgain, the allow rule for \u0027appdomain\u0027 above strongly suggests that this CL isn\u0027t opening a whole new category of access.",
      "parentUuid": "e30f1491_81f70e75",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9913181d_190b0db7",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-10-07T11:15:18Z",
      "side": 1,
      "message": "Remove blank line, and make the comment consistent with the others (Phonesky \u003d\u003d com.android.vending)",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 28
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "911717ec_7a04b301",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-10-07T11:15:18Z",
      "side": 1,
      "message": "\u003e Again, the allow rule for \u0027appdomain\u0027 above strongly suggests that this CL isn\u0027t opening a whole new category of access.\n\nHow so? vendor_app_file !\u003d vendor_apex_file",
      "parentUuid": "0a9a4ab5_08f2ab6e",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9d85b449_55832285",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-10-07T11:17:27Z",
      "side": 1,
      "message": "They are different, but very similar in terms of what they carry and how they are activated and updated.",
      "parentUuid": "911717ec_7a04b301",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9c0df821_4ff63e35",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2022-10-07T11:56:26Z",
      "side": 1,
      "message": "Should we consider a separate label for vendor provided apexes that apps should have access to? Similar to the same_process_hal_file which allows us to allow-list specific files that apps should have access to? Otherwise you open up the flood gates to compat issues where vendor apex updates can break apps.\n\n\u003e Note that we even have \"allow { appdomain -ephemeral_app -sdk_sandbox } vendor_app_file:file execute;\" for APKs.\n\nIMO this isn\u0027t a good example. It\u0027s just an artifact of the fact that we often route vendor provided apps into priv_app, untrusted_app, etc. So the rule is granted due to a limitation of the system, not because it\u0027s a good idea.",
      "parentUuid": "9913181d_190b0db7",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 28
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6dbd1e41_a58822c8",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-10-07T12:33:08Z",
      "side": 1,
      "message": "Ok. I think we first need to fully understand why Play wants an access to the vendor APEX files. I\u0027ve asked a question in the bug. b/247100406#comment17",
      "parentUuid": "9c0df821_4ff63e35",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 28
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bf1341dc_ed569213",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1415877
      },
      "writtenOn": "2022-11-15T04:29:50Z",
      "side": 1,
      "message": "Nikita answered in b/247100406#comment19. Let me repeat that here:\n\n\u003e Play app needs to be able to read Mainline APEXes, e.g. for delta patch optimization.\n\nSince the widevine apex is also handled like other Mainline APEXes, Play should have access to vendor apexes as well.\n\nAmended the comment.",
      "parentUuid": "6dbd1e41_a58822c8",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 28
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "8cd35a59_5628444e",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-11-18T01:21:12Z",
      "side": 1,
      "message": "Ack.",
      "parentUuid": "bf1341dc_ed569213",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 28
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5bcf1369_e1574c81",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2022-11-21T06:50:53Z",
      "side": 1,
      "message": "Isn\u0027t vendor_app_file being allowed just an artifact of all apps using the same zygote and how we can\u0027t (or at least don\u0027t) differentiate between apps installed on system and vendor? To do that we would either need a separate vendor zygote, or at least plumb through regular zygote the information about the app\u0027s origin, and then add an additional selector in seapp_contexts to allow differentiating in selinux policy. Anyway, I don\u0027t see us adding support for that so I guess we just need to approve this change, but it seems like a bug to me.",
      "parentUuid": "9d85b449_55832285",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e34ac5ce_2dfde6d3",
        "filename": "private/priv_app.te",
        "patchSetId": 6
      },
      "lineNbr": 193,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-11-21T07:08:11Z",
      "side": 1,
      "message": "I shouldn\u0027t have used vendor_app_file being allowed as a prior example.\n\nThe vendor zygote wouldn\u0027t solve the problem because it would still need access to platform-private files because zygote and the framework need them. Perhaps, a proper fix would be banning (and not supporting) APKs in the vendor partition, but we are too late.\n\nAnyway, an installer app having Read-only access to files (be it apk or apex) that it needs to update is NOT a Treble violation.",
      "parentUuid": "5bcf1369_e1574c81",
      "range": {
        "startLine": 192,
        "startChar": 0,
        "endLine": 193,
        "endChar": 62
      },
      "revId": "36645a53f87ef20af335247248dd99150053559f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}