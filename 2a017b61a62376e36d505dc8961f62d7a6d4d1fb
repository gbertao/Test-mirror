{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fb9d8b24_1aaaf247",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2022-03-08T22:32:03Z",
      "side": 1,
      "message": "Lokesh, I noticed odrefresh on Android is also allowed to use userfaultfd, but I don\u0027t think it\u0027s needed?  Should we remove that?",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "510ef2ac_0b211c3d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2022-03-08T22:35:26Z",
      "side": 1,
      "message": "Holding back for Orion to confirm if userfaultfd policy can be taken out from odrefresh. Otherwise LGTM.",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a56bd8ee_bc036194",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2022-03-08T22:35:26Z",
      "side": 1,
      "message": "I wasn\u0027t sure when I added the SELinux policy for userfaultfd if odrefresh would need it or not. Adding Orion to confirm about this.",
      "parentUuid": "fb9d8b24_1aaaf247",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "54d238f0_abb9a5da",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1071150
      },
      "writtenOn": "2022-03-09T09:19:15Z",
      "side": 1,
      "message": "jiakaiz@ owns odrefresh these days. AFAIK we don\u0027t instantiate any runtime in odrefresh itself code these days, but did consider that in earlier iterations.",
      "parentUuid": "510ef2ac_0b211c3d",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9ca49a67_08597659",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2022-03-09T14:18:19Z",
      "side": 1,
      "message": "Lokesh, how does dex2oat decide whether to use userfaultfd gc or not? Is the decision made by dex2oat itself or made by the caller and passed by a flag? If the latter one is the case, then odrefresh still need access to userfaultfd in order to make the right decision.",
      "parentUuid": "a56bd8ee_bc036194",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bc47627d_bd97ce3c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2022-03-09T17:25:51Z",
      "side": 1,
      "message": "Victor, let\u0027s not remove the policy from odrefresh yet. It\u0027s not certain if we would require invoking userfaultfd syscal in there or not.",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac81d7a9_35e5eb37",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1258954
      },
      "writtenOn": "2022-03-09T17:25:51Z",
      "side": 1,
      "message": "On the device dex2oat would know it just like it knows today that it needs to emit read-barriers using the runtime flags.\n\nIt would be trickier during build on host. We would require using device property to know that the build is for first_api_version \u003e\u003d 31, in which case we would not emit read-barrier, otherwise we would.\n\nRegarding odrefresh, given what you said, I think we should keep the selinux policy for a while, until we are certain if odrefresh may ever require doing userfaultfd or not.",
      "parentUuid": "9ca49a67_08597659",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ca383706_3d710cff",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1042276
      },
      "writtenOn": "2022-03-09T17:47:33Z",
      "side": 1,
      "message": "I\u0027d think it\u0027s safe to remove the policy for odrefresh (out of scope for this change) based on what you both said?  Since dex2oat can detect by itself, odrefresh doesn\u0027t need to do anything?",
      "parentUuid": "ac81d7a9_35e5eb37",
      "revId": "2a017b61a62376e36d505dc8961f62d7a6d4d1fb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}