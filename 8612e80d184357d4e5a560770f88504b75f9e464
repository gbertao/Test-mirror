{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "143a9c6c_fe91746e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 7
      },
      "lineNbr": 0,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2023-09-22T02:19:58Z",
      "side": 1,
      "message": "Hi Jeffrey, could you take a look at this CL when you get a chance? Thanks!",
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4f7a9f25_a8286dfd",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-22T07:48:17Z",
      "side": 1,
      "message": "Out of curiosity, why does it need to be a rawip_socket?",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2845f68a_ce5c4686",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2023-09-22T07:50:12Z",
      "side": 1,
      "message": "We need a SOCK_RAW socket to send and receive ICMPv6 messages. \n\n\nThe socket creation code looks like:\n```\nint sock \u003d socket(AF_INET6, SOCK_RAW, IPPROTO_ICMPV6);\n```",
      "parentUuid": "4f7a9f25_a8286dfd",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d132b98_c084784e",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-22T07:52:33Z",
      "side": 1,
      "message": "Why isn\u0027t that an icmp_socket?",
      "parentUuid": "2845f68a_ce5c4686",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "26e54309_b034bf20",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2023-09-22T07:54:00Z",
      "side": 1,
      "message": "I also tried icmp_socket in the ot_daemon.te file but it didn\u0027t work. I guess icmp_socket is for ICMPv4 only.",
      "parentUuid": "2d132b98_c084784e",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "359bc843_5ba39957",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-22T07:55:23Z",
      "side": 1,
      "message": "It\u0027s not.\n\nhttps://elixir.bootlin.com/linux/v6.5.4/source/security/selinux/hooks.c#L1156\n\nI\u0027m guessing that your socket creation is incorrect. It should be a SOCK_DGRAM, not SOCK_RAW.",
      "parentUuid": "26e54309_b034bf20",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c6880c8_b3d204fe",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2023-09-22T08:00:14Z",
      "side": 1,
      "message": "Thanks for pointing that out! I\u0027ll check if `SOCK_DGRAM` works for our case.",
      "parentUuid": "359bc843_5ba39957",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7031493e_301cb78e",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2023-09-22T08:57:52Z",
      "side": 1,
      "message": "It seems that the socket option `ICMP6_FILTER` (which we\u0027re using) needs a raw socket. If we use `SOCK_DGRAM` and try to set the filter, it will complain `Protocol not available`.",
      "parentUuid": "4c6880c8_b3d204fe",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0774e992_933887e5",
        "filename": "private/ot_daemon.te",
        "patchSetId": 7
      },
      "lineNbr": 24,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-22T09:02:44Z",
      "side": 1,
      "message": "Ah. From: https://nxmnpg.lemoda.net/4/icmp6\n```\nThe icmp6_filter structure may be used to refine the input message set according to the ICMPv6 type. By default, all messages types are allowed on newly created raw ICMPv6 sockets. The following macros may be used to refine the input set:\n\n```",
      "parentUuid": "7031493e_301cb78e",
      "range": {
        "startLine": 24,
        "startChar": 30,
        "endLine": 24,
        "endChar": 42
      },
      "revId": "8612e80d184357d4e5a560770f88504b75f9e464",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}