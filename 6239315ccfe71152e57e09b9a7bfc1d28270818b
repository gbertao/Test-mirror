{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "535126ef_c9edd162",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2021-03-11T04:26:56Z",
      "side": 1,
      "message": "Note to Jeffrey. adbd has been using this vsock. It\u0027s just that nobody depended on it so far. We now depend on the functionality.",
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7dd178b_c12ea512",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 48,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-11T09:21:19Z",
      "side": 1,
      "message": "create_socket_perms_no_ioctl ?",
      "range": {
        "startLine": 48,
        "startChar": 29,
        "endLine": 48,
        "endChar": 86
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27c3e73c_bd426ee0",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-11T09:21:19Z",
      "side": 1,
      "message": "why is it unlabled? Rather than grant this permission, let\u0027s figure out why it\u0027s unlabeled and figure out how set it up properly.",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22f64ba7_071c0501",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2021-03-11T09:37:05Z",
      "side": 1,
      "message": "I suspect that socket returned by \"accept\" is unlabeled. How can we figure out that?",
      "parentUuid": "27c3e73c_bd426ee0",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2321c45b_68b6558a",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2021-03-11T09:48:28Z",
      "side": 1,
      "message": "It seems that I need to take a look at file_contexts..",
      "parentUuid": "22f64ba7_071c0501",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "865cfd46_66a46eb4",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-11T09:50:21Z",
      "side": 1,
      "message": "You could try calling getpeercon() on it.\n\nhttps://man7.org/linux/man-pages/man3/freecon.3.html",
      "parentUuid": "22f64ba7_071c0501",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "da468808_174da928",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2021-03-12T06:26:32Z",
      "side": 1,
      "message": "To be clear, the code for the socket manipulation is here:\n\nhttp://cs/android/packages/modules/adb/daemon/transport_local.cpp?l\u003d75\u0026rcl\u003d22a32a99e75d86aa52bf4f93e48d04a694252f42\n\nListening socket is a vsock, and a socket returned by accept() is unlabeled. I tried calling getpeercon() but it failed with \"Protocol not available\".\n\ne.g. looking through our source tree, cuttlefish is already doing similar: aosp/930616",
      "parentUuid": "865cfd46_66a46eb4",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f673e5f1_21798d25",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1293738
      },
      "writtenOn": "2021-03-12T06:38:04Z",
      "side": 1,
      "message": "I think this socket class might require upstream changes to Linux to be labeled. \n\nI\u0027m not sure it\u0027s a use case that\u0027s been considered previously.\n\nCF does what it does in local sepolicy today because we were previously told to label sockets and have not had time to investigate this problem further; IOW, it is not a good precedent to follow.",
      "parentUuid": "da468808_174da928",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "de107797_ed0f7135",
        "filename": "private/adbd.te",
        "patchSetId": 1
      },
      "lineNbr": 49,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-12T08:01:11Z",
      "side": 1,
      "message": "\u003e I think this socket class might require upstream changes to Linux to be labeled. \n\nI strongly suspect that this is true. You\u0027ll need to figure out how this works for other socket types and figure out why vsock behaves differently.",
      "parentUuid": "f673e5f1_21798d25",
      "range": {
        "startLine": 49,
        "startChar": 11,
        "endLine": 49,
        "endChar": 20
      },
      "revId": "6239315ccfe71152e57e09b9a7bfc1d28270818b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}