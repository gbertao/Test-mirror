{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "2b07d59c_e1c31847",
        "filename": "private/coredomain.te",
        "patchSetId": 6
      },
      "lineNbr": 159,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-19T06:41:48Z",
      "side": 1,
      "message": "We actually want this to be domain (all processes) not just coredomain (mostly processes on the system image). We don\u0027t want vendors to be able to use uprobes to inspect other processes.",
      "range": {
        "startLine": 159,
        "startChar": 4,
        "endLine": 159,
        "endChar": 14
      },
      "revId": "7e009860e99137196924fbcd5e60f6be890265c8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "541b2214_f1d037b6",
        "filename": "private/coredomain.te",
        "patchSetId": 6
      },
      "lineNbr": 159,
      "author": {
        "id": 1952023
      },
      "writtenOn": "2023-09-21T21:52:20Z",
      "side": 1,
      "message": "Applying the restriction to domain causes a bunch of violations, e.g. hal_bluetooth, hal_telephony_server, and hal_wifi which all have access to sysfs_type.\n\nI changed the neverallow rule to restrict self:capability2 perfmon instead.",
      "parentUuid": "2b07d59c_e1c31847",
      "range": {
        "startLine": 159,
        "startChar": 4,
        "endLine": 159,
        "endChar": 14
      },
      "revId": "7e009860e99137196924fbcd5e60f6be890265c8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6cdd15e9_6d0bb283",
        "filename": "private/coredomain.te",
        "patchSetId": 6
      },
      "lineNbr": 159,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-09-22T07:29:24Z",
      "side": 1,
      "message": "That\u0027s really unfortunate. What do we actually need to care about here? What does read access actually provide?\n\nPerhaps for now you can go through the violations and exempt sysfs_uprobe from the allow:\n\nE.g. r_dir_file(hal_bluetooth, { sysfs_type -sysfs_uprobe })...\n\nBut I feel like we need to have a more general conversation about what we\u0027re trying to enforce here (and why). I don\u0027t feel like I have a good understanding.",
      "parentUuid": "541b2214_f1d037b6",
      "range": {
        "startLine": 159,
        "startChar": 4,
        "endLine": 159,
        "endChar": 14
      },
      "revId": "7e009860e99137196924fbcd5e60f6be890265c8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}