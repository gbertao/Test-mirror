{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "979b12be_cad35de0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2022-12-15T21:58:14Z",
      "side": 1,
      "message": "+ Jiyong while Steven is out. This is for moving libsensorndkbridge to use the AIDL sensorservice in https://googleplex-android-review.git.corp.google.com/c/platform/frameworks/hardware/interfaces/+/20696278",
      "revId": "89e0a6d93bf96165761966a2e792b92e498427ab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47986e8a_24d601b9",
        "filename": "vendor/hal_camera_default.te",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1132673
      },
      "writtenOn": "2022-12-16T00:53:04Z",
      "side": 1,
      "message": "Is this `fwk_sensor_service` used? Nobody seems to be able to add that service. Search query is [1]. I expected somethihg like `add_service(something, fwk_sensor_service)`, but there isn\u0027t.\n\nAlso, please don\u0027t give the permission explicitly like this. Use macros [2]. So, for example,\n\n```\nin hal_camera_default.te:\nhal_client_domain(hal_camera_default, fw_sensor_service);\n\nin public/attributes:\nhal_attribute(fw_sensor_service); \n\nin public/fwk_sensor_service.te:\nhal_attribute_service(fwk_sensor_service, ...)\n\n\n[1] https://cs.android.com/search?q\u003dfwk_sensor_service%20f:sepolicy%20\u0026ss\u003dandroid%2Fplatform%2Fsuperproject\n\n[2] https://source.android.com/docs/core/architecture/aidl/aidl-hals#sepolicy",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 65
      },
      "revId": "89e0a6d93bf96165761966a2e792b92e498427ab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2f286fb2_00a04621",
        "filename": "vendor/hal_camera_default.te",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2022-12-16T00:56:57Z",
      "side": 1,
      "message": "Yes, this resolves the avc denial when trying to get the service.\n\nThe hal_client_domain() macro doesn\u0027t work for this right now, probably because of the other missing macros you mention.\n\nI\u0027ll try to add all of that and see how it goes! Thanks.",
      "parentUuid": "47986e8a_24d601b9",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 65
      },
      "revId": "89e0a6d93bf96165761966a2e792b92e498427ab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a67d6896_95fd3062",
        "filename": "vendor/hal_camera_default.te",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2022-12-16T16:28:49Z",
      "side": 1,
      "message": "I tried a lot of things and couldn\u0027t find a solution using these macros. I\u0027m getting a lot of neverallows that are hard to understand and track down.\n\nNone of the existing android.frameworks* or android.system* services use any of the hal_* macros, so it seems like I need to do something else? Maybe the neverallows are coming form having system_server as the service?\n\nThe current patchset errors are in this paste: https://paste.googleplex.com/6310075575566336",
      "parentUuid": "2f286fb2_00a04621",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 65
      },
      "revId": "89e0a6d93bf96165761966a2e792b92e498427ab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49182dc5_30b83dd5",
        "filename": "vendor/hal_camera_default.te",
        "patchSetId": 1
      },
      "lineNbr": 10,
      "author": {
        "id": 1644679
      },
      "writtenOn": "2022-12-16T17:49:56Z",
      "side": 1,
      "message": "It looks like `system_server_service` conflicts with some `allow incidentd` to find the service. Removing `system_server_service` from the type gets past that.\n\nThe other 2 neverallows are hal_attribute macro that adds the no fork rules, which system_server violates.",
      "parentUuid": "a67d6896_95fd3062",
      "range": {
        "startLine": 10,
        "startChar": 0,
        "endLine": 10,
        "endChar": 65
      },
      "revId": "89e0a6d93bf96165761966a2e792b92e498427ab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}