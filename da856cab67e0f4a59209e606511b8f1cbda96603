{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5714d9f8_69d005f4",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1608690
      },
      "writtenOn": "2020-10-29T21:18:43Z",
      "side": 1,
      "message": "I think this change will break the devices which doesn\u0027t have USB adb. We won\u0027t be able to enable USB on those kinds of devices after this change.",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7f90e096_0aacebca",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1079148
      },
      "writtenOn": "2020-10-30T01:49:05Z",
      "side": 1,
      "message": "Well, the other change breaks tcp adb on every other device, so this needs to be fixed somehow.",
      "parentUuid": "5714d9f8_69d005f4",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86e3420c_6034c0d1",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1608690
      },
      "writtenOn": "2020-10-30T01:57:42Z",
      "side": 1,
      "message": "Understood and very agree we should fix it. Let\u0027s find a solution which works on both cases.\n\nHi Jiyong, could we make service.adb.tcp.port to be system_public_prop?",
      "parentUuid": "7f90e096_0aacebca",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e1fe3b11_d8d1201e",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2020-11-02T05:57:55Z",
      "side": 1,
      "message": "I don\u0027t fully understand the rationale, could you elaborate?\n\nWhat does this property do, and why both system and vendor have to touch it?",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df565e8b_151ac759",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1608690
      },
      "writtenOn": "2020-11-02T17:04:39Z",
      "side": 1,
      "message": "The background is that the default adbd protocol is USB adb, and \"service.adb.tcp.port\" property is set, adbd will be started with TCP protocol.\n\nWe have two cases. \n\n@Josh, please correct me if anything is wrong.\n\n1. The device has USB adb. In this case, \"adb tcp 5555\" command will restart adbd and adbd will set \"service.adb.tcp.port\" property before it\u0027s restarted. After the adbd is restarted, the TCP adb protocol will be used. To support this command, adbd must be able to set this property.\n\n2. The device doesn\u0027t have USB adb. In this case, we need the adbd to be started with TCP protocol while booting up. To do that, we want vendor_init to set \"service.adb.tcp.port\" property.",
      "parentUuid": "e1fe3b11_d8d1201e",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "032b652f_b107b218",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2020-11-03T09:25:22Z",
      "side": 1,
      "message": "Please add neverallow rules in hgchen@\u0027s comments.",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "a255bc07_e304f071",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2020-11-03T09:25:22Z",
      "side": 1,
      "message": "ack",
      "parentUuid": "df565e8b_151ac759",
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67353107_b16277a1",
        "filename": "public/property.te",
        "patchSetId": 3
      },
      "lineNbr": 58,
      "author": {
        "id": 1608690
      },
      "writtenOn": "2020-10-30T05:17:02Z",
      "side": 1,
      "message": "I think we can do the following changes. By doing this, both your case and my cases should work.\n\n1. remove \"system_vendor_config_prop(adbd_config_prop)\" from public/property.te\n\n2. add \"set_prop(adbd, adbd_config_prop)\" to private/adbd.te\n\n3. add \"neverallow { domain -init -adbd -vendor_init } adbd_config_prop:property_service set;\" to private/property.te\n\n4. add \"set_prop(vendor_init, adbd_config_prop)\" to private/vendor_init.te",
      "range": {
        "startLine": 58,
        "startChar": 0,
        "endLine": 58,
        "endChar": 40
      },
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "903ab588_495fbec4",
        "filename": "public/property.te",
        "patchSetId": 3
      },
      "lineNbr": 58,
      "author": {
        "id": 1608690
      },
      "writtenOn": "2020-10-30T05:53:55Z",
      "side": 1,
      "message": "Sorry, I forget this change: \n\n5. add \"system_public_prop(adbd_config_prop)\" to public/property.te.",
      "parentUuid": "67353107_b16277a1",
      "range": {
        "startLine": 58,
        "startChar": 0,
        "endLine": 58,
        "endChar": 40
      },
      "revId": "da856cab67e0f4a59209e606511b8f1cbda96603",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}