{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "f0f5e397_6da1ea33",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-01-23T13:37:53Z",
      "side": 1,
      "message": "Need to merge https://android-review.git.corp.google.com/c/platform/system/vold/+/2398952?tab\u003dcomments first. Failures are from a conflict between AOSP and internal commits.",
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "64b1bee8_63627918",
        "filename": "private/fuseblk_compart.te",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "for naming consistency, I wonder if you should use fuseblk and fuseblk_untrusted?",
      "range": {
        "startLine": 1,
        "startChar": 14,
        "endLine": 1,
        "endChar": 29
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "87554cf4_060042a8",
        "filename": "private/fuseblk_compart.te",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "For fuseblk, I went with fuseblk_fs as the domain and fuseblk as the filesystem because the convention in file.te seemed to be that specific filesystems are referred to by their name (see fuse). I think I can rename it from fuseblk_fs to something else, but renaming to fuseblk might lead to some confusion.\n\nFor fuseblk_untrusted, my particular worry is that while the naming pattern is fuseblk/fuseblk_untrusted like fsck/fsck_untrusted, we are doing something a bit different here in that fuseblk_untrusted isn\u0027t really untrusted, it has a lot of permissions, it just doesn\u0027t happen to have sys_admin and the associated mounting permissions. Unlike fsck/fsck_untrusted, it\u0027s not a strict hierarchy where you should choose based on the trust level of your program, fuseblk should transition in and out of fuseblk_compart.\n\nWhat do you think? This is minor and I can change it either way. Perhaps something like \"fuseblk_binary\" and \"fuseblk_admin\" might be more clear?",
      "parentUuid": "64b1bee8_63627918",
      "range": {
        "startLine": 1,
        "startChar": 14,
        "endLine": 1,
        "endChar": 29
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5864d0b_5b946011",
        "filename": "private/fuseblk_compart.te",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-02T10:12:25Z",
      "side": 1,
      "message": "\u003e For fuseblk, I went with fuseblk_fs as the domain and fuseblk as the filesystem because the convention in file.te seemed to be that specific filesystems are referred to by their name (see fuse). I think I can rename it from fuseblk_fs to something else, but renaming to fuseblk might lead to some confusion.\n\nDoesn\u0027t this seem slightly backwards? presumably \"fs\" stands for \"filesystem\". So the actual filesystem doesn\u0027t have \"_fs\" but the process does?\n\nI wouldn\u0027t go with fuseblk_binary. A very common naming convention in Android is that daemons end in \"d\" e.g. installd, vold, adbd, netd, etc. Perhaps fuseblkd?\n\n\u003e For fuseblk_untrusted, my particular worry is that while the naming pattern is fuseblk/fuseblk_untrusted like fsck/fsck_untrusted, we are doing something a bit different here in that fuseblk_untrusted isn\u0027t really untrusted, it has a lot of permissions, it just doesn\u0027t happen to have sys_admin and the associated mounting permissions. Unlike fsck/fsck_untrusted, it\u0027s not a strict hierarchy where you should choose based on the trust level of your program, fuseblk should transition in and out of fuseblk_compart.\n\nIsn\u0027t this true for the others as well? fuseblk doesn\u0027t look privileged to me compared to fsck_untrusted. Untrusted is simply saying that compromising this daemon doesn\u0027t lead to a complete device compromise via CAP_SYS_ADMIN, or the ability to mount filesystems.\n\nI wonder if you should go with fuseblkd and fuseblkd_untrusted?",
      "parentUuid": "87554cf4_060042a8",
      "range": {
        "startLine": 1,
        "startChar": 14,
        "endLine": 1,
        "endChar": 29
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "85c23fe4_5e104304",
        "filename": "private/fuseblk_compart.te",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-02T11:01:28Z",
      "side": 1,
      "message": "That seems consistent to me; I\u0027ll rename to fuseblkd and fuseblkd_untrusted.",
      "parentUuid": "b5864d0b_5b946011",
      "range": {
        "startLine": 1,
        "startChar": 14,
        "endLine": 1,
        "endChar": 29
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "67a6f8f7_c0da5f53",
        "filename": "private/mediaprovider_app.te",
        "patchSetId": 2
      },
      "lineNbr": 15,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "should this be create_dir_perms (and create_file_perms below)? Should mediaprovider be allowed to create files and dirs?",
      "range": {
        "startLine": 15,
        "startChar": 36,
        "endLine": 15,
        "endChar": 48
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41ff09bc_e35e5a32",
        "filename": "private/mediaprovider_app.te",
        "patchSetId": 2
      },
      "lineNbr": 15,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Yes, this was an artifact of a previous schema that blocked file creation. Changed.",
      "parentUuid": "67a6f8f7_c0da5f53",
      "range": {
        "startLine": 15,
        "startChar": 36,
        "endLine": 15,
        "endChar": 48
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4721731f_95438885",
        "filename": "private/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 15,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "I think you actually want domain_auto_trans() here. The above instances needed to use domain_trans() because the same domain is used to enter different domains, but that\u0027s not the case here. You can then simplify your code to not include the setcon() (or whatever it is you\u0027re using). It will automatically do the correct domain transition.",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 12
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4df519b8_650be6ba",
        "filename": "private/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 15,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Removed. Simplified vold code to not explicitly set the domain.",
      "parentUuid": "4721731f_95438885",
      "range": {
        "startLine": 15,
        "startChar": 0,
        "endLine": 15,
        "endChar": 12
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d5b1ef7_9bb5d69e",
        "filename": "public/fsck_untrusted.te",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "Line 55 is already accomplishing this, so you can delete this line. See:\nhttps://cs.android.com/android/platform/superproject/+/master:system/sepolicy/public/global_macros?q\u003dglobal_capability_class_set",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 54,
        "endChar": 70
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "027b904c_a4c0fd39",
        "filename": "public/fsck_untrusted.te",
        "patchSetId": 2
      },
      "lineNbr": 54,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "6d5b1ef7_9bb5d69e",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 54,
        "endChar": 70
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "82e99431_07de2ab7",
        "filename": "public/ioctl_defines",
        "patchSetId": 2
      },
      "lineNbr": 173,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "I can\u0027t seem to figure out where this is used.",
      "range": {
        "startLine": 173,
        "startChar": 0,
        "endLine": 173,
        "endChar": 33
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3ba8ee55_dc7b8e52",
        "filename": "public/ioctl_defines",
        "patchSetId": 2
      },
      "lineNbr": 173,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Discussed internally.",
      "parentUuid": "82e99431_07de2ab7",
      "range": {
        "startLine": 173,
        "startChar": 0,
        "endLine": 173,
        "endChar": 33
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7b1fb82_c388967e",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 172,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "delete, this is should already be included by the domain_trans() macro that you\u0027re using elsewhere.",
      "range": {
        "startLine": 171,
        "startChar": 0,
        "endLine": 172,
        "endChar": 54
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f07a2aef_0a53aee9",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 172,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Removed.",
      "parentUuid": "b7b1fb82_c388967e",
      "range": {
        "startLine": 171,
        "startChar": 0,
        "endLine": 172,
        "endChar": 54
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4d2815ef_79be9155",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "Isn\u0027t this being handled elsewhere?",
      "range": {
        "startLine": 180,
        "startChar": 0,
        "endLine": 180,
        "endChar": 56
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b24d4283_9ceea359",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 180,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Yes. Removed.",
      "parentUuid": "4d2815ef_79be9155",
      "range": {
        "startLine": 180,
        "startChar": 0,
        "endLine": 180,
        "endChar": 56
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3f492fbf_ac92d975",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 215,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2023-02-01T10:59:10Z",
      "side": 1,
      "message": "do we really want this? Don\u0027t we want only the non-sys-admin thing to access this?",
      "range": {
        "startLine": 213,
        "startChar": 0,
        "endLine": 215,
        "endChar": 38
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2d0ffd15_886fc52d",
        "filename": "public/vold.te",
        "patchSetId": 2
      },
      "lineNbr": 215,
      "author": {
        "id": 1963014
      },
      "writtenOn": "2023-02-01T14:39:41Z",
      "side": 1,
      "message": "Correct. Removed.",
      "parentUuid": "3f492fbf_ac92d975",
      "range": {
        "startLine": 213,
        "startChar": 0,
        "endLine": 215,
        "endChar": 38
      },
      "revId": "896cac00e4bba0255df64bd315bca9f596ef3f67",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}