# nfc subsystem
type android_hardware_nfc_1_0_service, domain;
type android_hardware_nfc_1_0_service_exec, exec_type, file_type;

# may be started by init
init_daemon_domain(android_hardware_nfc_1_0_service)

allow android_hardware_nfc_1_0_service android_hardware_nfc_1_0_service_exec:file rx_file_perms;

# hwbinder access
hwbinder_use(android_hardware_nfc_1_0_service)

# call into NFC process (callbacks)
binder_call(android_hardware_nfc_1_0_service, nfc)

# Set NFC properties
set_prop(android_hardware_nfc_1_0_service, nfc_prop)

# NFC device access.
allow android_hardware_nfc_1_0_service nfc_device:chr_file rw_file_perms;

# Data file accesses.
allow android_hardware_nfc_1_0_service nfc_data_file:dir create_dir_perms;
allow android_hardware_nfc_1_0_service nfc_data_file:notdevfile_class_set create_file_perms;

allow android_hardware_nfc_1_0_service sysfs_nfc_power_writable:file rw_file_perms;
allow android_hardware_nfc_1_0_service sysfs:file write;

# TODO: added to match above sysfs rule. Remove me?
allow android_hardware_nfc_1_0_service sysfs_usb:file write;
