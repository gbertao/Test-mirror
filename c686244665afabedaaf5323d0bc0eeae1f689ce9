{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "5568ea08_d677c3d6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000205
      },
      "writtenOn": "2023-11-03T19:44:31Z",
      "side": 1,
      "message": "I don\u0027t know how you plan to make AVF and/or crosvm available in the /vendor partition, but this CL allows me to run a /vendor/crosvm binary directly.",
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3e0df58_febe9959",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-11-06T09:24:19Z",
      "side": 1,
      "message": "Could you explain what you\u0027re trying to do?\nThe bug (and its parents) don\u0027t provide any context.",
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5be956a_8f8b504d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-11-06T09:24:19Z",
      "side": 1,
      "message": "The internal AVF AIDL APIs aren\u0027t stable, so they can\u0027t be used across the system/vendor interface.\nThe Java @SystemApi can be used from vendor, I think, but may be too limiting.",
      "parentUuid": "5568ea08_d677c3d6",
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f46edd0d_a817de8c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 1000205
      },
      "writtenOn": "2023-11-07T01:39:24Z",
      "side": 1,
      "message": "We want to run a trusty vendor vm on cuttlefish to test the hwcrypto and secure storage hals. We also want to test gatekeeper and keymint TAs running in a vendor vm.",
      "parentUuid": "d3e0df58_febe9959",
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "893cb8dc_241eb7c1",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-11-06T09:24:19Z",
      "side": 1,
      "message": "I don\u0027t think you need any of this - you\u0027re creating a vendor_crosvm domain, but AFAICT it\u0027s identical to the crosvm domain, so it doesn\u0027t seem to be needed.\nIf it is, it should be in a separate vendor_crosvm.te.\n\nBut I think all you need to do is label your copy of the crosvm binary as crosvm_exec and then you can re-use the existing domain.",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c47fb228_94a3a8db",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000205
      },
      "writtenOn": "2023-11-07T01:39:24Z",
      "side": 1,
      "message": "I tried using the crosvm_exec label, but it failed. I don\u0027t remember the exact error, but crosvm is marked as coredomain, which I think prevents me from using it for a vendor binary, and vendor_crosvm that I add here is not.",
      "parentUuid": "893cb8dc_241eb7c1",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "37808cef_856af638",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-11-07T10:57:22Z",
      "side": 1,
      "message": "Hmm. @inseob@google.com might have a suggestion?",
      "parentUuid": "c47fb228_94a3a8db",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f4245006_c2d04939",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1291338
      },
      "writtenOn": "2023-11-21T01:16:53Z",
      "side": 1,
      "message": "The bug doesn\u0027t explain the detailed design; why do we need this?\n\nVendor binaries communicating directly to system internal binaries (e.g. `virtualizationmanager`, `adbd`) are violating Treble. And I don\u0027t think we need all of these. Instead, we\u0027ll need to add a separate domain `vendor_crosvm` (or, even better, a generic name which can refer to any VMMs) and then move some types to `system/sepolicy/public`.",
      "parentUuid": "37808cef_856af638",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b6dd8ddf_b28df65a",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1000205
      },
      "writtenOn": "2023-11-21T01:40:10Z",
      "side": 1,
      "message": "The usecase for this is to start a vendor vm from an init script on the vendor partition. This is prevented, as you say, and this cl creates a separate vendor_crosvm domain to at least allow a vendor copy of the crosvm binary to exist. I did it here, instead of a separate file, to simplify managing the permissions crosvm needs (this file defines neverallow rules that need to name the new allowed domain).\n\nb/309149829, which I should probably link to here instead, has some discussion about this and alternative solutions.",
      "parentUuid": "f4245006_c2d04939",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "86f42d2e_b4941bc2",
        "filename": "private/crosvm.te",
        "patchSetId": 1
      },
      "lineNbr": 8,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2023-11-21T13:49:54Z",
      "side": 1,
      "message": "As discussed on that bug, this definitely isn\u0027t the right approach.",
      "parentUuid": "b6dd8ddf_b28df65a",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 8,
        "endChar": 33
      },
      "revId": "c686244665afabedaaf5323d0bc0eeae1f689ce9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}