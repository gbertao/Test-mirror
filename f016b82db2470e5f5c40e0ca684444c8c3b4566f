{
  "comments": [
    {
      "key": {
        "uuid": "27dc1dce_d9fa967c",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 549,
      "author": {
        "id": 1026058
      },
      "writtenOn": "2017-11-30T18:46:17Z",
      "side": 1,
      "message": "I remember discussing this before, on the first internal version of this change, but why do we need these here?  PLAT_VENDOR was because we didn\u0027t have a place to put odm platform defaults, but I\u0027d rather just not include those at all and add support for that later as-needed.  BOARD_VENDOR_SEPOLICY_DIRS seems out of place entirely.",
      "range": {
        "startLine": 548,
        "startChar": 44,
        "endLine": 549,
        "endChar": 31
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a0964389_b9dda75f",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 549,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2017-12-01T06:36:09Z",
      "side": 1,
      "message": "Yup, that was based on previous discussions.\n\nBut I found an issue when testing (b/64240127#comment10).\nThere will be build break if only moving \"device/google/wahoo/sepolicy/verizon\" to BOARD_ODM_SEPOLICY.\n\ndevice/google/wahoo/sepolicy/verizon/obdm_app.te:9:ERROR \u0027unknown type diag_device\u0027 at token \u0027;\u0027 \n\nBecause it has dependency on \"device/google/wahoo/sepolicy/vendor\", where \"type diag_device\" is defined.\n\nODM is an extension of vendor, so it should be legitimate to allow ODM depends on Vendor, but not vice versa.\n\nNote that the final odm_sepolicy.cil still doesn\u0027t contain duplicated content in vendor_sepolicy.cil. It will be stripped out at line 573.\n\nSound good?",
      "parentUuid": "27dc1dce_d9fa967c",
      "range": {
        "startLine": 548,
        "startChar": 44,
        "endLine": 549,
        "endChar": 31
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2dbbeb8d_1edfe087",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 549,
      "author": {
        "id": 1026058
      },
      "writtenOn": "2017-12-06T16:32:26Z",
      "side": 1,
      "message": "This goes back to my comment#2 in b/64240127.\n\nIf we are allowing odm to depend on vendor policy, then this prevents vendor policy from being independently updated, in which case I think a huge amount of this complexity is unwarranted (why have separate odm policy at all when we could just build a new vendor policy that happens to live in /odm)?  There are two/three conceptual ways I view this as going:\n\nsystem -\u003e vendor -\u003e odm (odm depends on vendor which depends on system).  This is currently unsupported due to the absence of the compatibility structure that we added for the system -\u003e vendor split.\n\nAlternatively, there could also be system -\u003e vendor and system -\u003e odm, which allows for independent updates, but prevents interaction between the vendor and odm bits\u003e\n\nAlternatively as well, there could be  a system -\u003e [vendor -\u003e odm] where as soon as you add odm bits, vendor can no longer be updated or a vendor update requires odm update too.\n\nI just looked up the previous time this came up here: https://googleplex-android-review.googlesource.com/c/platform/system/sepolicy/+/2835429/2/Android.mk#604\n\nand realize I didn\u0027t see your second comment (which contradicts the first somewhat, but does clarify that we\u0027re in the 3rd scenario.  So, given that, why do we need any of this ODM stuff at all?  Why not just add the odm policy to the set of vendor sources and call it a day? (and yes, I realize this means that all the time spent on this large patch-set would be wasted \u003d/)",
      "parentUuid": "a0964389_b9dda75f",
      "range": {
        "startLine": 548,
        "startChar": 44,
        "endLine": 549,
        "endChar": 31
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b816a0f_a9b83077",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 549,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2017-12-07T03:26:24Z",
      "side": 1,
      "message": "Yes, current scenario is the 3rd one (system -\u003e [vendor -\u003e odm]), and your statement is correct!\n\nre:  So, given that, why do we need any of this ODM stuff at all?  Why not just add the odm policy to the set of vendor sources and call it a day?\n\nThis is just the first step to support \"single vendor.img\" per SoC. Let me send an e-mail for clarification.\n\n\nre: I realize this means that all the time spent on this large patch-set would be wasted \u003d\n\nIt\u0027s ok, I think we\u0027ll still need this eventually someday.",
      "parentUuid": "2dbbeb8d_1edfe087",
      "range": {
        "startLine": 548,
        "startChar": 44,
        "endLine": 549,
        "endChar": 31
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0854b77c_4f8d0dc9",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 549,
      "author": {
        "id": 1026058
      },
      "writtenOn": "2017-12-13T22:42:32Z",
      "side": 1,
      "message": "After malchev@\u0027s comments on e-mail thread:\n\n\"\"\"\n-- the ability to have an odm partition that is just like the vendor partition in all respects\n-- the ability to have an sepolicy that is merged between vendor and odm, at run time, but without any restrictions.  TBH I don\u0027t even know if what I just said makes sense :)\n\"\"\"\n\nI\u0027m going to say that this is currently an implementation detail/hack to allow checkpolicy to work.  Since we\u0027re filtering this out below anyway, I guess we can proceed here...",
      "parentUuid": "3b816a0f_a9b83077",
      "range": {
        "startLine": 548,
        "startChar": 44,
        "endLine": 549,
        "endChar": 31
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce05c37c_10136e37",
        "filename": "Android.mk",
        "patchSetId": 2
      },
      "lineNbr": 573,
      "author": {
        "id": 1080813
      },
      "writtenOn": "2017-11-30T14:44:57Z",
      "side": 1,
      "message": "Needed for `make checkbuild`, because BOARD_ODM_SEPOLICY_DIRS is undefined in any project now. \u0027grep\u0027 returns 1 when there is no output, which cause build error.",
      "range": {
        "startLine": 573,
        "startChar": 44,
        "endLine": 573,
        "endChar": 51
      },
      "revId": "f016b82db2470e5f5c40e0ca684444c8c3b4566f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}