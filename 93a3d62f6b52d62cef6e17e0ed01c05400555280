{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5190926a_e5cd2e99",
        "filename": "private/bpfloader.te",
        "patchSetId": 2
      },
      "lineNbr": 9,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-03-15T09:02:00Z",
      "side": 1,
      "message": "I wonder if this should just be \"create_dir_perms\". That\u0027s more robust and ensures that we haven\u0027t forgotten anything that we\u0027ll use later (e.g. we\u0027re missing read, getattr, etc). bpfloader is responsible for ownership of these dirs, so it\u0027s reasonable that it have all the necessary permissions.",
      "range": {
        "startLine": 9,
        "startChar": 31,
        "endLine": 9,
        "endChar": 84
      },
      "revId": "93a3d62f6b52d62cef6e17e0ed01c05400555280",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6dc6577_aa087a26",
        "filename": "private/bpfloader.te",
        "patchSetId": 2
      },
      "lineNbr": 9,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-03-15T09:12:29Z",
      "side": 1,
      "message": "Hmm:\n\ndefine(`r_dir_perms\u0027, `{ open getattr read search ioctl lock watch watch_reads }\u0027)\ndefine(`w_dir_perms\u0027, `{ open search write add_name remove_name lock }\u0027)\ndefine(`ra_dir_perms\u0027, `{ r_dir_perms add_name write }\u0027)\ndefine(`rw_dir_perms\u0027, `{ r_dir_perms w_dir_perms }\u0027)\ndefine(`create_dir_perms\u0027, `{ create reparent rename rmdir setattr rw_dir_perms }\u0027)\n\nso that would allow rmdir and I don\u0027t really want anybody ever changing things once they\u0027re created/pinned... bad enough we have to allow file rename to work around selinux genfscon.\n\nIf I could I\u0027d prefer all of these things to be create-with-right-privs-only but I just haven\u0027t found a way to do it (yet?).\n\nFurthermore bpffs is *very* virtual and weird, so they don\u0027t quite behave like normal files.\n\nWhat would be really great is if we could ship sepolicy snippets via mainline...",
      "parentUuid": "5190926a_e5cd2e99",
      "range": {
        "startLine": 9,
        "startChar": 31,
        "endLine": 9,
        "endChar": 84
      },
      "revId": "93a3d62f6b52d62cef6e17e0ed01c05400555280",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2e3f2e16_77144823",
        "filename": "private/bpfloader.te",
        "patchSetId": 2
      },
      "lineNbr": 9,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-03-15T09:17:11Z",
      "side": 1,
      "message": "Perhaps { rw_dir_perms setattr } ?\n\nSince you\u0027re arguing for this to be more restrictive than I was proposing, I\u0027m more than happy to go with your proposal.\n\n\u003e What would be really great is if we could ship sepolicy snippets via mainline...\n\nI do not disagree, but it\u0027s actually a surprisingly hard problem to solve. Happy to share more if you\u0027re interested.",
      "parentUuid": "a6dc6577_aa087a26",
      "range": {
        "startLine": 9,
        "startChar": 31,
        "endLine": 9,
        "endChar": 84
      },
      "revId": "93a3d62f6b52d62cef6e17e0ed01c05400555280",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f35a2f41_3a0687a4",
        "filename": "private/bpfloader.te",
        "patchSetId": 2
      },
      "lineNbr": 33,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2024-03-15T09:02:00Z",
      "side": 1,
      "message": "same as above.",
      "range": {
        "startLine": 33,
        "startChar": 48,
        "endLine": 33,
        "endChar": 93
      },
      "revId": "93a3d62f6b52d62cef6e17e0ed01c05400555280",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}