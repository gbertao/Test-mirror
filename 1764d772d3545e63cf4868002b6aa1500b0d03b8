{
  "comments": [
    {
      "key": {
        "uuid": "b6842784_6cd25a94",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2018-10-02T23:49:54Z",
      "side": 1,
      "message": "Why was this line not required before? Is it because netutils_wrapper was already able to access system_file? If so, can/should that access be removed? Or is it not possible because we wouldn\u0027t be able to do things like exec iptables?",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fd87fa82_08f9ab08",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2018-10-03T00:02:29Z",
      "side": 1,
      "message": "Until the label of this file changed, the ability to lock files on /system was granted through the macro on line 3.\n\nI don\u0027t know if netutils_wrapper still needs this functionality.",
      "parentUuid": "b6842784_6cd25a94",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02f20684_69b56fa7",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2018-10-03T00:09:01Z",
      "side": 1,
      "message": "AIUI what needs to work is vendor code (e.g., netmgrd) execing /system/bin/iptables-wrapper-1.0, which is a symlink to /system/bin/netutils-wrapper. That then execs /system/bin/iptables, which needs to flock /system/etc/xtables.lock.",
      "parentUuid": "fd87fa82_08f9ab08",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9998bc95_b26b01a0",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2018-10-03T00:17:17Z",
      "side": 1,
      "message": "Is netmgrd access to /system/etc/xtables.lock always go through /system/bin/netutils-wrapper? If that\u0027s the case, then xtables.lock access is always in netutils_wrapper domain, i.e we don\u0027t need this change.",
      "parentUuid": "02f20684_69b56fa7",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8cee66d0_94f502f7",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2018-10-03T00:20:33Z",
      "side": 1,
      "message": "My understanding is that vendor code is not allowed to exec iptables directly because it can\u0027t exec files on system, and so has to go through the wrappers. But at this point I\u0027m not so sure of this.",
      "parentUuid": "9998bc95_b26b01a0",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7b9807e8_5fe3c98a",
        "filename": "private/netutils_wrapper.te",
        "patchSetId": 5
      },
      "lineNbr": 5,
      "author": {
        "id": 1124693
      },
      "writtenOn": "2018-10-03T00:30:40Z",
      "side": 1,
      "message": "I think it makes sense to force vendor code to go to netutils_wrapper for iptables then (via neverallows). That way we don\u0027t need expose this lock and potentially other shared resources moving forward.",
      "parentUuid": "8cee66d0_94f502f7",
      "range": {
        "startLine": 4,
        "startChar": 0,
        "endLine": 5,
        "endChar": 66
      },
      "revId": "1764d772d3545e63cf4868002b6aa1500b0d03b8",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}