{
  "comments": [
    {
      "key": {
        "uuid": "cedcd471_6c7eedee",
        "filename": "private/system_server.te",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2019-01-16T17:09:58Z",
      "side": 1,
      "message": "Is this sufficient? If this is gated by a signature|privileged permission, then this likely needs to be \"{ platform_app priv_app system_app }\" and potentially others, such as radio, bluetooth etc.",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 30
      },
      "revId": "63a4a344c774da73afdab30238fa8b09b9c7db2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "80a87990_f8b458d6",
        "filename": "private/system_server.te",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2019-01-17T04:45:05Z",
      "side": 1,
      "message": "Anyway to make this generic *:tcp_socket or something?",
      "parentUuid": "cedcd471_6c7eedee",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 30
      },
      "revId": "63a4a344c774da73afdab30238fa8b09b9c7db2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "dc4e89e7_4df5487d",
        "filename": "private/system_server.te",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2019-01-17T04:49:59Z",
      "side": 1,
      "message": "generic would be:\nallow system_server domain:tcp_socket ioctl;",
      "parentUuid": "80a87990_f8b458d6",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 30
      },
      "revId": "63a4a344c774da73afdab30238fa8b09b9c7db2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9c15a7c7_cf58121e",
        "filename": "private/system_server.te",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2019-01-17T05:11:23Z",
      "side": 1,
      "message": "looks like domain should probably be generic, but ioctl no\n\nallowxperm system_server domain:tcp_socket ioctl { 0xSSSS 0xTTTT };\n\nPer https://selinuxproject.org/page/XpermRules#ioctl_Operation_Rules\nyou may also need:\n\nAs the ioctl(2) function requires a file descriptor, its context must match the process context otherwise the fd { use } class/permission is required.",
      "parentUuid": "dc4e89e7_4df5487d",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 30
      },
      "revId": "63a4a344c774da73afdab30238fa8b09b9c7db2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1f9f2bf_3aebe27a",
        "filename": "private/system_server.te",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2019-01-17T05:14:54Z",
      "side": 1,
      "message": "And it sounds like Jeff has already stated in an email thread that:\n\nYou need both rules\n\n# allow system_server to call ioctl() on this system_app created socket.\nallow system_server system_app:tcp_socket ioctl;\n# allow system_server to use the ioctl command TIOCOUTQ on this system_app created socket.\nallowxperm system_server system_app:tcp_socket ioctl 0x5411;",
      "parentUuid": "9c15a7c7_cf58121e",
      "range": {
        "startLine": 55,
        "startChar": 20,
        "endLine": 55,
        "endChar": 30
      },
      "revId": "63a4a344c774da73afdab30238fa8b09b9c7db2a",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}