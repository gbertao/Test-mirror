{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "82a48f9b_d13ea8b8",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-05-11T08:38:52Z",
      "side": 1,
      "message": "How do we clearly indicate which ALSA pcm driver is for use by the audio system and which is for use by the vibrator system? I am afraid that without exclusion mechanism we face some racy situations during the init/enumeration phase at least.",
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1b1f4faa_7347d7cb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1756352
      },
      "writtenOn": "2021-05-11T19:01:41Z",
      "side": 1,
      "message": "@Carter will you be able to answer this?",
      "parentUuid": "82a48f9b_d13ea8b8",
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c7236dc1_2d8bef4c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1870616
      },
      "writtenOn": "2021-05-12T00:53:34Z",
      "side": 1,
      "message": "For now, Vibrator HAL will access\n\n1. /dev/snd/pcmC0D24p or /dev/snd/pcmC1D24p, the hostless FrontEnd to enable the haptic pcm amplifier\n\n2. the /dev/snd/controlC0 or /dev/snd/controlC1 to send the mixer control to configure the TDM setting of the haptic amplifier and clock.\n\nSo we can say #1 is for vibrator HAL only but regarding #2, both vibrator HAL and Audio HAL needs to access it.\n\nIf we have concern on accessing #2, then we can also try to move the ALSA commands of controlling the haptic TDM setting to the mixer_paths.xml table of the Audio HAL. In this case, the vibrator HAL only needs to access #1.",
      "parentUuid": "1b1f4faa_7347d7cb",
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "163d8459_059d0cc7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-05-12T07:02:19Z",
      "side": 1,
      "message": "I don\u0027t think this is the right approach, and I share Eric\u0027s concerns about the problems of two HALs having conflicting access to the same driver.\n\nI think a better approach (if it\u0027s possible) is to give /dev/snd/pcmC1D24p a different label in device-specific policy. That way we can ensure that:\n- only the vibrator HAL may access it.\n- the vibrator HAL cannot access other audio resources\n- The audio HAL cannot unintentionally access vibrator resources.",
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a17ec83c_4e165bd7",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1003259
      },
      "writtenOn": "2021-05-11T08:38:52Z",
      "side": 1,
      "message": "If we make this change, the comment must be updated.",
      "range": {
        "startLine": 34,
        "startChar": 2,
        "endLine": 34,
        "endChar": 55
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d91da0f2_a6eb69ea",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 34,
      "author": {
        "id": 1756352
      },
      "writtenOn": "2021-05-11T19:01:41Z",
      "side": 1,
      "message": "Certainly I can do this. I can change it to \"Only audio HAL and vibrator HAL may directly access the audio hardware\"",
      "parentUuid": "a17ec83c_4e165bd7",
      "range": {
        "startLine": 34,
        "startChar": 2,
        "endLine": 34,
        "endChar": 55
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "84efeea9_1b85e6f9",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1347177
      },
      "writtenOn": "2021-05-10T01:26:58Z",
      "side": 1,
      "message": "Would it be better to have a attribute to escape from this neverallow and let hal_audio_server, hal_omx_server, hal_vibrator_server have it?\n\nattribute:\nattribute audio_special_server;\n\nhal_audio.te:\nneverallow { halserverdomain -audio_special_server } ...\n\nother te file:\ntypeattribute hal_audio_server audio_special_server;",
      "range": {
        "startLine": 35,
        "startChar": 64,
        "endLine": 35,
        "endChar": 83
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a699c14_56154267",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1208973
      },
      "writtenOn": "2021-05-10T14:05:34Z",
      "side": 1,
      "message": "Either way seems to work to me (as long as you ensure the atttribute isn\u0027t public).\n\nBy the way, where is the allow rule for this added?",
      "parentUuid": "84efeea9_1b85e6f9",
      "range": {
        "startLine": 35,
        "startChar": 64,
        "endLine": 35,
        "endChar": 83
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79be329e_785add90",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1756352
      },
      "writtenOn": "2021-05-10T18:35:22Z",
      "side": 1,
      "message": "Hi Joel,\n\nThe allow rule for this is added in ag/14391534. When you say as long as the attribute isn\u0027t public, do you mean that should be defined internally, not AOSP?\n\nHi Adam,\n\nWould you be able to assist in making this change?",
      "parentUuid": "9a699c14_56154267",
      "range": {
        "startLine": 35,
        "startChar": 64,
        "endLine": 35,
        "endChar": 83
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9d39a628_6b2c0e0c",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1208973
      },
      "writtenOn": "2021-05-10T18:37:42Z",
      "side": 1,
      "message": "Private such that vendor policy cannot use it for their types (i.e., only core policy can declare what it is).",
      "parentUuid": "79be329e_785add90",
      "range": {
        "startLine": 35,
        "startChar": 64,
        "endLine": 35,
        "endChar": 83
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "45b8351e_a25cf178",
        "filename": "public/hal_audio.te",
        "patchSetId": 2
      },
      "lineNbr": 35,
      "author": {
        "id": 1347177
      },
      "writtenOn": "2021-05-12T01:14:32Z",
      "side": 1,
      "message": "I think that public/ cannot access private stuff, so my proposal cannot apply. Current setting is fine.",
      "parentUuid": "9d39a628_6b2c0e0c",
      "range": {
        "startLine": 35,
        "startChar": 64,
        "endLine": 35,
        "endChar": 83
      },
      "revId": "96fd8586c33f6d43b9a92a97b443c6d413954989",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}