{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "335cd61e_41e1a5c5",
        "filename": "private/otapreopt_chroot.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-04T08:37:39Z",
      "side": 1,
      "message": "does this work? the macro for this only takes 3 arguments. Seems like a bug that this even compiles. https://cs.android.com/android/platform/superproject/+/master:system/sepolicy/public/te_macros?q\u003ddomain_auto_trans\n\nI also don\u0027t think that domain_auto_trans() macro is also not what you want. Simply adding something like the following should be sufficient:\n\notapreopt_chroot linkerconfig_exec:file rx_file_perms;",
      "range": {
        "startLine": 39,
        "startChar": 74,
        "endLine": 39,
        "endChar": 86
      },
      "revId": "549aca01f005428ae150116f8eabf5a5f41141eb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "35a3973f_e732cb3d",
        "filename": "private/otapreopt_chroot.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2021-03-04T17:30:05Z",
      "side": 1,
      "message": "No this doesn\u0027t work. It does compile though.\n\nI was hoping this would be easy but it looks like even after chroot selinux remembers the earlier permissions.\n\nI\u0027ll probably need your or someone elses help to create the new policies. Do you have anyone in MTV?",
      "parentUuid": "335cd61e_41e1a5c5",
      "range": {
        "startLine": 39,
        "startChar": 74,
        "endLine": 39,
        "endChar": 86
      },
      "revId": "549aca01f005428ae150116f8eabf5a5f41141eb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "f8a8ddbf_258ed2ef",
        "filename": "private/otapreopt_chroot.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-04T17:36:55Z",
      "side": 1,
      "message": "I\u0027ll be online for a bit, and would be happy to help.\n\nCan you post the denials that you\u0027re trying to address? That would probably be sufficient for me to help.",
      "parentUuid": "35a3973f_e732cb3d",
      "range": {
        "startLine": 39,
        "startChar": 74,
        "endLine": 39,
        "endChar": 86
      },
      "revId": "549aca01f005428ae150116f8eabf5a5f41141eb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "42921077_8d8f276d",
        "filename": "private/otapreopt_chroot.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1047769
      },
      "writtenOn": "2021-03-04T18:24:34Z",
      "side": 1,
      "message": "Currently I have:\n\n03-04 09:19:08.378 20436 20436 I otapreopt_chroot: Activated 0 packages. Skipped: 0\n03-04 09:19:08.376 20495 20495 I otapreopt_chroo: type\u003d1400 audit(0.0:283): avc: denied { execute } for name\u003d\"linkerconfig\" dev\u003d\"loop51\" ino\u003d19 scontext\u003du:r:otapreopt_chroot:s0 tcontext\u003du:object_r:linkerconfig_exec:s0 t\nclass\u003dfile permissive\u003d1\n03-04 09:19:08.376 20495 20495 I otapreopt_chroo: type\u003d1400 audit(0.0:283): avc: denied { read open } for path\u003d\"/apex/com.android.runtime/bin/linkerconfig\" dev\u003d\"loop51\" ino\u003d19 scontext\u003du:r:otapreopt_chroot:s0 tcontext\u003du\n:object_r:linkerconfig_exec:s0 tclass\u003dfile permissive\u003d1\n03-04 09:19:08.376 20495 20495 I otapreopt_chroo: type\u003d1400 audit(0.0:283): avc: denied { execute_no_trans } for path\u003d\"/apex/com.android.runtime/bin/linkerconfig\" dev\u003d\"loop51\" ino\u003d19 scontext\u003du:r:otapreopt_chroot:s0 tco\nntext\u003du:object_r:linkerconfig_exec:s0 tclass\u003dfile permissive\u003d1\n03-04 09:19:08.376 20495 20495 I linkerconfig: type\u003d1400 audit(0.0:283): avc: denied { map } for path\u003d\"/apex/com.android.runtime/bin/linkerconfig\" dev\u003d\"loop51\" ino\u003d19 scontext\u003du:r:otapreopt_chroot:s0 tcontext\u003du:object_r\n:linkerconfig_exec:s0 tclass\u003dfile permissive\u003d1\n03-04 09:19:08.421 20495 20495 E linkerconfig: Failed to scan APEX modules : Can\u0027t read /apex/apex-info-list.xml: No such file or directory\n03-04 09:19:08.416 20495 20495 I linkerconfig: type\u003d1400 audit(0.0:284): avc: denied { write } for name\u003d\"kmsg\" dev\u003d\"tmpfs\" ino\u003d5 scontext\u003du:r:otapreopt_chroot:s0 tcontext\u003du:object_r:kmsg_device:s0 tclass\u003dchr_file permis\nsive\u003d1\n\nBut the ota is still not working even with setenforce 0 (linker errors) so there might be more in the future.",
      "parentUuid": "f8a8ddbf_258ed2ef",
      "range": {
        "startLine": 39,
        "startChar": 74,
        "endLine": 39,
        "endChar": 86
      },
      "revId": "549aca01f005428ae150116f8eabf5a5f41141eb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "451ea644_1e07a49e",
        "filename": "private/otapreopt_chroot.te",
        "patchSetId": 1
      },
      "lineNbr": 39,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2021-03-04T19:16:09Z",
      "side": 1,
      "message": "I think the following should be sufficient:\notapreopt_chroot linkerconfig_exec:file rx_file_perms;",
      "parentUuid": "42921077_8d8f276d",
      "range": {
        "startLine": 39,
        "startChar": 74,
        "endLine": 39,
        "endChar": 86
      },
      "revId": "549aca01f005428ae150116f8eabf5a5f41141eb",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}