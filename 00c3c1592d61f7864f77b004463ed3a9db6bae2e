{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "04077780_09b7ceec",
        "filename": "private/artd.te",
        "patchSetId": 1
      },
      "lineNbr": 85,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-12-12T16:58:24Z",
      "side": 1,
      "message": "For this particular one, I think you only need to allow privapp_data_file, as we don\u0027t allow symlinks elsewhere: cs.android.com/android/platform/superproject/+/master:system/sepolicy/private/mls;drc\u003d06edcd8250a249192981c7fbeea196249394b9ad;l\u003d69\n\nAnd that avoids touching the scary neverallow below.",
      "range": {
        "startLine": 85,
        "startChar": 11,
        "endLine": 85,
        "endChar": 29
      },
      "revId": "00c3c1592d61f7864f77b004463ed3a9db6bae2e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "44c2654f_b0e57d6d",
        "filename": "private/artd.te",
        "patchSetId": 1
      },
      "lineNbr": 85,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-12-12T16:58:24Z",
      "side": 1,
      "message": "FWIW { getattr read } is all you actually need for lnk_file; but r_file_perms is commonly used \u0026 harmless.",
      "range": {
        "startLine": 85,
        "startChar": 39,
        "endLine": 85,
        "endChar": 51
      },
      "revId": "00c3c1592d61f7864f77b004463ed3a9db6bae2e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "9bba5d35_b0f4c8ed",
        "filename": "private/artd.te",
        "patchSetId": 1
      },
      "lineNbr": 85,
      "author": {
        "id": 1884045
      },
      "writtenOn": "2022-12-12T17:25:10Z",
      "side": 1,
      "message": "There are other types of app data files, such as bluetooth_data_file, nfc_data_file, etc. Are we sure that bluetooth packages etc. don\u0027t use symlinks for secondary dex files?\n\nAnother way to avoid the scary neverallow below is to only exclude shell_data_file from this. WDYT?",
      "parentUuid": "04077780_09b7ceec",
      "range": {
        "startLine": 85,
        "startChar": 11,
        "endLine": 85,
        "endChar": 29
      },
      "revId": "00c3c1592d61f7864f77b004463ed3a9db6bae2e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e347ee88_0c636a11",
        "filename": "private/artd.te",
        "patchSetId": 1
      },
      "lineNbr": 85,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-12-12T18:06:45Z",
      "side": 1,
      "message": "\u003e There are other types of app data files, such as bluetooth_data_file, nfc_data_file, etc. Are we sure that bluetooth packages etc. don\u0027t use symlinks for secondary dex files?\n\nYes. \"Secondary\" means loaded from another app, I think? That rule I pointed you at blocks one app reading symlinks from another app\u0027s data directory at all, except for privapp_data_file; there are no other exceptions.",
      "parentUuid": "9bba5d35_b0f4c8ed",
      "range": {
        "startLine": 85,
        "startChar": 11,
        "endLine": 85,
        "endChar": 29
      },
      "revId": "00c3c1592d61f7864f77b004463ed3a9db6bae2e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "74c94bdf_4180094e",
        "filename": "public/domain.te",
        "patchSetId": 1
      },
      "lineNbr": 1111,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2022-12-12T16:58:24Z",
      "side": 1,
      "message": "This one is a little scary; I can see potential symlink attacks given that shell_data_file can be written to via adb.",
      "range": {
        "startLine": 1111,
        "startChar": 1,
        "endLine": 1111,
        "endChar": 7
      },
      "revId": "00c3c1592d61f7864f77b004463ed3a9db6bae2e",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}