{
  "comments": [
    {
      "key": {
        "uuid": "1a97a9eb_fb599a93",
        "filename": "private/mlstrustedsubject.te",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2020-02-12T14:39:33Z",
      "side": 1,
      "message": "Also setattr unlink link rename ?\nAnything else?",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 52
      },
      "revId": "e357508163aefb5d12efe86da3d5e8d690cb7e9f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e4b4a418_13c967c3",
        "filename": "private/mlstrustedsubject.te",
        "patchSetId": 1
      },
      "lineNbr": 9,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-02-13T10:54:40Z",
      "side": 1,
      "message": "~{ read write map getattr }\n\nalso\nneverallow { mlstrusted...} { app_data_file privapp... } dir *;",
      "parentUuid": "1a97a9eb_fb599a93",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 52
      },
      "revId": "e357508163aefb5d12efe86da3d5e8d690cb7e9f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "324c0894_1bbc7617",
        "filename": "private/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-02-13T10:54:40Z",
      "side": 1,
      "message": "Is this really necessary? this means that apps can grant shell access to their private dir by overriding the default DAC permissions. That seems like an unfortunate regression.",
      "range": {
        "startLine": 1,
        "startChar": 32,
        "endLine": 1,
        "endChar": 49
      },
      "revId": "e357508163aefb5d12efe86da3d5e8d690cb7e9f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7366f615_fd0c5305",
        "filename": "private/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2020-02-13T12:53:29Z",
      "side": 1,
      "message": "But the TE rules prevent it?\n$ sesearch --allow -s shell -t app_data_file /tmp/policy\nallow shell app_data_file:file { read write getattr map };\n\nThe way I\u0027ve set it up, granting mlstrustedsubject automatically removes your access to app_data_file. (I was quite pleased with that tbh.)\n\nIn terms of whether it\u0027s necessary: Shell seems to store some things under data/data (eg files/heapdumps), with label shell_data_file, so this means it can still do so even if data/data itself were to be levelFrom user.",
      "parentUuid": "324c0894_1bbc7617",
      "range": {
        "startLine": 1,
        "startChar": 32,
        "endLine": 1,
        "endChar": 49
      },
      "revId": "e357508163aefb5d12efe86da3d5e8d690cb7e9f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f128bdb5_15e48784",
        "filename": "private/shell.te",
        "patchSetId": 1
      },
      "lineNbr": 1,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-02-13T13:04:56Z",
      "side": 1,
      "message": "Ah, good point.\n\n\u003e (I was quite pleased with that tbh.)\n\n:)",
      "parentUuid": "7366f615_fd0c5305",
      "range": {
        "startLine": 1,
        "startChar": 32,
        "endLine": 1,
        "endChar": 49
      },
      "revId": "e357508163aefb5d12efe86da3d5e8d690cb7e9f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}