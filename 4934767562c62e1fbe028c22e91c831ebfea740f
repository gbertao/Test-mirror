{
  "comments": [
    {
      "key": {
        "uuid": "454d200a_2c3b6f81",
        "filename": "private/file_contexts",
        "patchSetId": 28
      },
      "lineNbr": 77,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2017-01-26T17:15:19Z",
      "side": 1,
      "message": "tabs or spaces for new entries?",
      "range": {
        "startLine": 77,
        "startChar": 19,
        "endLine": 77,
        "endChar": 24
      },
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2d494dd1_df49d10d",
        "filename": "private/file_contexts",
        "patchSetId": 28
      },
      "lineNbr": 77,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T17:19:26Z",
      "side": 1,
      "message": "Spaces preferred, but, if surrounding entries use tabs, no problem with tabs. We might replace al of them with space in a separate CL later...",
      "range": {
        "startLine": 77,
        "startChar": 19,
        "endLine": 77,
        "endChar": 24
      },
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bcd77328_53311095",
        "filename": "private/file_contexts",
        "patchSetId": 28
      },
      "lineNbr": 77,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T17:36:41Z",
      "side": 1,
      "message": "Is this a file or a device?",
      "range": {
        "startLine": 77,
        "startChar": 35,
        "endLine": 77,
        "endChar": 54
      },
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c2bb549b_19500170",
        "filename": "private/file_contexts",
        "patchSetId": 28
      },
      "lineNbr": 77,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2017-01-26T18:10:58Z",
      "side": 1,
      "message": "1) I will keep it space, this is the policy for both Android and Kernel to fix style as you touch individual pieces to reduce the impact of future cleanups.\n2) File, leveraging the device tmpfs. Similar class as properties dynamic mmap\u0027d store directory tree, but a single file. See line 156. Was not comfortable with _device suffix. runtime_event_log_tags_device gets my spidey senses tingling as disingenuous.",
      "range": {
        "startLine": 77,
        "startChar": 35,
        "endLine": 77,
        "endChar": 54
      },
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4d6c2949_d29f9d87",
        "filename": "private/logd.te",
        "patchSetId": 28
      },
      "lineNbr": 13,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T17:36:41Z",
      "side": 1,
      "message": "The commit message says untrusted app and such are not permitted to access the file, but this neverallow rule does not cover that case (untrusted_app is in appdomain).",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8444a7e7_e1ca550e",
        "filename": "private/logd.te",
        "patchSetId": 28
      },
      "lineNbr": 13,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2017-01-26T18:10:58Z",
      "side": 1,
      "message": "Ok, I need a primer on the envisioned application classes and hierarchy. I had -appdomain here, and yet when I added untrusted_app to allow it access, I had to also add -untrusted_app here. Or is this \u0027fixed\u0027 now and I need to retest?\n\nWhat how should I separate them out as, what is the set of all applications that land on /system (but are not untrusted_app)? system_app? priv_app? What about Device owner? Chrome wants to extend the event log tags, will fall to \u0027plan b\u0027 slow long path registration, I expect it is untrusted_app, but is it?",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e93c3c23_6ee6fe1d",
        "filename": "private/logd.te",
        "patchSetId": 28
      },
      "lineNbr": 13,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T18:27:41Z",
      "side": 1,
      "message": "Here\u0027s the current \"hierarchy\" (it\u0027s a set really, not hierarchical):\n$ sepolicy-analyze out/target/product/bullhead/root/sepolicy attribute appdomain\n\nbluetooth\nephemeral_app\nisolated_app\nnfc\nplatform_app\npriv_app\nradio\nshared_relro\nshell\nsu\nsystem_app\nuntrusted_app\n\nWhat you probably want to do is have two separate rules: one for everything except appdomain, the other for appdomain. For example, the current rule is precisely the first rule I\u0027m talking about. The rule does not cover appdomain. You can now add a second neverallow rule into app.te, which will apply to certain domains in appdomain set. For example, if you want to explicitly enumerate which appdomain domains are permitted access:\n\nneverallow {\n  appdomain\n  -priv_app\n  -system_app\n  -platform_app\n} ...\n\nOR, if you want to explicitly enumerate which appdomains should be denied access, add per-domain rules into corresponding domain-specific .te files. For example, untrusted_app.te:\n\nneverallow untrusted_app ...;",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "04885493_4658c666",
        "filename": "public/te_macros",
        "patchSetId": 28
      },
      "lineNbr": 348,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T17:36:41Z",
      "side": 1,
      "message": "Is there a better more descriptive name? How about read_logd_dynamic_tags or similar? Something with a verb, probably.",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b12734cc_6fb122b0",
        "filename": "public/te_macros",
        "patchSetId": 28
      },
      "lineNbr": 348,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2017-01-26T18:10:58Z",
      "side": 1,
      "message": "If I made it much longer, I would be tempted to just land\n\nallow domain event_log_tags_file:file r_file_perms;\n\nI don\u0027t like dynamic in the macro name unless we rename event_log_tags_file to dynamic_event_log_tags_file. This is really a runtime registration event log tags file, it grows without bounds (to an asymptote) until reboot.\n\nKISS Plan (if acceptable):\n- rename event_log_tags_file to runtime_event_log_tags_file\n- rename macro to read_runtime_log_tags\n- writers (logd and init) will not use a macro to add their write access.\n\n[TL;DR]\n\nOf course, this is a legacy from before where we erroneously thought we could declare anything bundled on /system as having access to the file, and anything not bundled would be denied. Essentially before if you can not read this file, then you have no rights posting events messages to the log. But that is not the case, we are limiting access to trusted bundled system applications only.\n\nSince we can not differentiate applications on /system, and store applications, all as untrusted_app, I will always remain troubled ;-/",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2c834455_eda2aa68",
        "filename": "public/te_macros",
        "patchSetId": 28
      },
      "lineNbr": 348,
      "author": {
        "id": 1018773
      },
      "writtenOn": "2017-01-26T18:27:41Z",
      "side": 1,
      "message": "I like the plan.\n\nWhat legacy do you mean? untrusted_app can be both pre-installed and post-installed. It is by design that it does not matter whether an untrusted app comes from /system, /vendor or from /data. If you want to grant access to more privileged apps only, you need to cut out untrusted_app, isolated_app, ephemeral_app at the very least. Or you can specifically target the types of higher-privileged apps, such as priv_app, system_app, platform_app.",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "40488b98_d666ca25",
        "filename": "public/te_macros",
        "patchSetId": 28
      },
      "lineNbr": 348,
      "author": {
        "id": 1032276
      },
      "writtenOn": "2017-01-26T21:15:58Z",
      "side": 1,
      "message": "legacy is the long life this CL has had, from beginning to this point ...",
      "revId": "4934767562c62e1fbe028c22e91c831ebfea740f",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}