{
  "comments": [
    {
      "key": {
        "uuid": "c99ff75a_f6fbbb28",
        "filename": "private/bpfloader.te",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2019-01-04T18:39:14Z",
      "side": 1,
      "message": "why are these needed?",
      "range": {
        "startLine": 17,
        "startChar": 46,
        "endLine": 17,
        "endChar": 64
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4fb2f5c6_7525f3f8",
        "filename": "private/bpfloader.te",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 1124848
      },
      "writtenOn": "2019-01-04T18:48:16Z",
      "side": 1,
      "message": "agreed",
      "parentUuid": "c99ff75a_f6fbbb28",
      "range": {
        "startLine": 17,
        "startChar": 46,
        "endLine": 17,
        "endChar": 64
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "357e6534_dc631334",
        "filename": "private/bpfloader.te",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 1121354
      },
      "writtenOn": "2019-01-04T19:01:01Z",
      "side": 1,
      "message": "This is required for retrieving maps from a pinned location when netd crashes and restarts. We don\u0027t create new maps in that case and just reuse the existing ones. I think getting bpf objects from a pinned location need both read \u0026 write permission.",
      "parentUuid": "c99ff75a_f6fbbb28",
      "range": {
        "startLine": 17,
        "startChar": 46,
        "endLine": 17,
        "endChar": 64
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f139785_c9ce7ac4",
        "filename": "private/bpfloader.te",
        "patchSetId": 4
      },
      "lineNbr": 17,
      "author": {
        "id": 1124848
      },
      "writtenOn": "2019-01-04T19:09:30Z",
      "side": 1,
      "message": "This rule is for \u0027bpfloader\u0027, not for \u0027netd\u0027. Its \"allow bpfloader\". So did you mean bpfloader crashing?\n\nThe scenario I was thinking of is if the bpfloader crashes while loading the program. In this case its possible maps were created and pinned but the program was not loaded yet. Then on a restart, bpfloader needs to reuse the pinned maps (but not create them), and then load the program. If opening a pinned map needs read/write, then we need the permissions.\n\nIf netd is accessing pinned maps, then you need a similar rule to \"allow netd\", no?",
      "parentUuid": "357e6534_dc631334",
      "range": {
        "startLine": 17,
        "startChar": 46,
        "endLine": 17,
        "endChar": 64
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "093e8dc3_fe4e64d1",
        "filename": "private/system_server.te",
        "patchSetId": 4
      },
      "lineNbr": 846,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2019-01-04T18:39:14Z",
      "side": 1,
      "message": "this can be deleted now right? netd can no longer create bpf maps.",
      "range": {
        "startLine": 846,
        "startChar": 0,
        "endLine": 846,
        "endChar": 38
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69107090_14368c04",
        "filename": "private/system_server.te",
        "patchSetId": 4
      },
      "lineNbr": 846,
      "author": {
        "id": 1124848
      },
      "writtenOn": "2019-01-04T18:48:16Z",
      "side": 1,
      "message": "this is map_read though right? not map_create. I think it still needs to be able to read maps",
      "parentUuid": "093e8dc3_fe4e64d1",
      "range": {
        "startLine": 846,
        "startChar": 0,
        "endLine": 846,
        "endChar": 38
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b01908a2_123067d9",
        "filename": "private/system_server.te",
        "patchSetId": 4
      },
      "lineNbr": 846,
      "author": {
        "id": 1124848
      },
      "writtenOn": "2019-01-04T18:49:15Z",
      "side": 1,
      "message": "Ah sorry I misunderstood your comment. You are right, it should be deleteable",
      "parentUuid": "69107090_14368c04",
      "range": {
        "startLine": 846,
        "startChar": 0,
        "endLine": 846,
        "endChar": 38
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3a20456_d51763d9",
        "filename": "private/system_server.te",
        "patchSetId": 4
      },
      "lineNbr": 846,
      "author": {
        "id": 1121354
      },
      "writtenOn": "2019-01-04T19:01:01Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b01908a2_123067d9",
      "range": {
        "startLine": 846,
        "startChar": 0,
        "endLine": 846,
        "endChar": 38
      },
      "revId": "f1afa98ed6ee6ce383333cdb24e4ea55f18c5573",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}