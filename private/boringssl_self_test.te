typeattribute boringssl_self_test coredomain;

type boringssl_self_test_exec, system_file_type, exec_type, file_type;
type boringssl_self_test_marker, file_type;

# switch to boringssl_self_test security domain when running boringssl_self_test_exec from init.
domain_auto_trans(init, boringssl_self_test_exec, boringssl_self_test)

# Allow boringssl_self_test binaries to create/check for the existence of boringssl_self_test_marker
# files.
allow boringssl_self_test_exec boringssl_self_test_marker:file { read write };

# Allow init to run boringssl_self_test_exec executables.
allow init boringssl_self_test_exec:file execute;

# Allow all executable to read the boringssl_self_test_marker files.
# allow exec_type boringssl_self_test_marker:file read
