typeattribute ashmemd coredomain;
type ashmemd_exec, exec_type, file_type, system_file_type;

init_daemon_domain(ashmemd)

binder_use(ashmemd)
add_service(ashmemd, ashmem_device_service)

allow ashmemd ashmem_device:chr_file rw_file_perms;

# TODO(134693809): Add neverallow rule to prevent vendor domains from opening
# /dev/ashmem directly.
# Audit vendor code that opens /dev/ashmem directly.
auditallow { domain -coredomain -appdomain } ashmem_device:chr_file open;
