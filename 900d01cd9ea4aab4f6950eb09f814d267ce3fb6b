{
  "comments": [
    {
      "key": {
        "uuid": "cbba8cef_fa039f23",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-09-18T10:25:11Z",
      "side": 1,
      "message": "So this service should be available to all apps? Privileged apps? Third party apps? Instant apps?",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1cdda656_698ff194",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-09-18T10:25:11Z",
      "side": 1,
      "message": "This service runs in system_server?",
      "range": {
        "startLine": 133,
        "startChar": 76,
        "endLine": 133,
        "endChar": 97
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9529fb43_8a4752f1",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1749734
      },
      "writtenOn": "2020-09-18T10:30:27Z",
      "side": 1,
      "message": "It should be available to privileged apps only, should I change something here to enforce that?",
      "parentUuid": "cbba8cef_fa039f23",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9e92f841_fee37d44",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1749734
      },
      "writtenOn": "2020-09-18T10:30:27Z",
      "side": 1,
      "message": "Yes, ag/12408009 if you want to take a look.  System server marshals the request between the client and the service that does the recognition.",
      "parentUuid": "1cdda656_698ff194",
      "range": {
        "startLine": 133,
        "startChar": 76,
        "endLine": 133,
        "endChar": 97
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "38f60616_b5c5d53d",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-09-18T12:15:50Z",
      "side": 1,
      "message": "In that case, please remove app_api_service and ephemeral_app_api_service, and add the service manually to the app domain that needs access.\n\nFor example:\nhttps://android-review.googlesource.com/c/platform/system/sepolicy/+/1163839/6/private/priv_app.te\n\nBut don\u0027t assume it\u0027s the \"priv_app\" domain. Actually check the selinux denial. Also, please include the selinux denial in the commit message.",
      "parentUuid": "9529fb43_8a4752f1",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96e55080_481eafa3",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1749734
      },
      "writtenOn": "2020-09-22T10:13:10Z",
      "side": 1,
      "message": "Hi Jeffrey, I removed app_api_service and ephemeral_app_api_service from service.te (leaving system_server_service and service_manager_type) but my app was still able to access the service without a selinux error in logcat.\n\nI did have a permission error because there\u0027s a required system app permission checked in java code, but I didn\u0027t think it was related so I removed it to let the call succeed and hopefully get the selinux denial, but it didn\u0027t come.\n\nMy flow is:\n\n// System app\ncontext.getSystemService(MusicRecognitionService.class).foo();\n\nSystem server receives the request, does some audio stuff, then binds to a Service in another app.\n\nOther app responds back through system server, and callback in my system app is invoked.\n\nAny debugging tips?",
      "parentUuid": "38f60616_b5c5d53d",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb3614f8_415b69e1",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1054468
      },
      "writtenOn": "2020-09-22T12:25:37Z",
      "side": 1,
      "message": "Is your app running as the system UID?",
      "parentUuid": "96e55080_481eafa3",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "402301a4_3c07e3e2",
        "filename": "public/service.te",
        "patchSetId": 1
      },
      "lineNbr": 133,
      "author": {
        "id": 1749734
      },
      "writtenOn": "2020-09-22T13:18:19Z",
      "side": 1,
      "message": "I don\u0027t think so, here\u0027s a log out of system server:\n\n09-22 15:17:27.181  1695  5606 W System.err: ONI: api called by pid\u003d3310 uid\u003d10170",
      "parentUuid": "eb3614f8_415b69e1",
      "range": {
        "startLine": 133,
        "startChar": 32,
        "endLine": 133,
        "endChar": 74
      },
      "revId": "900d01cd9ea4aab4f6950eb09f814d267ce3fb6b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}