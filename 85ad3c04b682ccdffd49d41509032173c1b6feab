{
  "comments": [
    {
      "key": {
        "uuid": "62b79bdc_2c6363e3",
        "filename": "private/app.te",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2017-01-28T01:10:00Z",
      "side": 1,
      "message": "qtaguid_proc is a file (aka /proc/net/xt_qtaguid/ctrl), not a directory or symlink. The r_dir_file() macro grants read permission on files, symlinks, and directories. The latter two permissions don\u0027t make any sense.\n\nLine 144 already grants read/write access to qtaguid_proc, so using r_dir_file() to again grant read access is redundant.\n\nqtaguid_proc only covers /proc/net/xt_qtaguid/ctrl . /proc/net/xt_qtguid/stats does not use the qtaguid_proc label, but rather, uses the generic proc_net label, which is already addressed through line 148 below.\n\nThis line can be deleted.",
      "revId": "85ad3c04b682ccdffd49d41509032173c1b6feab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9935b0e2_3c8a9d98",
        "filename": "private/app.te",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 1022895
      },
      "writtenOn": "2017-01-28T01:19:50Z",
      "side": 1,
      "message": "Since everyone who can read one can read both how about changing qtaguid_proc to cover /proc/net/xt_qtaguid?",
      "revId": "85ad3c04b682ccdffd49d41509032173c1b6feab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b1123bba_76527af1",
        "filename": "private/app.te",
        "patchSetId": 1
      },
      "lineNbr": 146,
      "author": {
        "id": 1003966
      },
      "writtenOn": "2017-01-28T20:00:50Z",
      "side": 1,
      "message": "appdomain is allowed read-WRITE access to qtaguid_proc (line 144), so changing the label of /proc/net/xt_qtguid from proc_net to qtaguid_proc would allow write access to files where previously only read access was granted. I haven\u0027t analyzed the effect of making these previously read-only files writable.\n\nIn addition, changing /proc/net/xt_qtguid from proc_net to qtaguid_proc would have the effect of removing access to these files for domains which had proc_net access, but currently have no rules for accessing qtaguid_proc. For instance, netd currently has the following rule:\n\n  r_dir_file(netd, proc_net)\n  # For /proc/sys/net/ipv[46]/route/flush.\n  allow netd proc_net:file rw_file_perms;\n\nbut has no rules for qtaguid_proc. If netd is reading proc/net/xt_qtguid, and the label is changed, netd would no longer have permissions to read these files without a policy change. We would need to fixup the policy to allow read access to qtaguid_proc for all domains which have read access to proc_net, or otherwise determine that this functionality isn\u0027t required.",
      "revId": "85ad3c04b682ccdffd49d41509032173c1b6feab",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": false
    }
  ]
}