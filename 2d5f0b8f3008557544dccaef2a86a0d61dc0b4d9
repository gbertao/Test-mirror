{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "c6d7e7fb_cdbc36ee",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T10:35:26Z",
      "side": 1,
      "message": "How did you confirm that?\n\nNothing here grants any process access to the service, so I don\u0027t think you\u0027d be able to get an instance of it from service manager.\n\nIf this is intended for 3P app usage, I suggest you add the app_api_service attribute in your type declaration; we already have e.g.  `allow untrusted_app_all app_api_service:service_manager find;` in the policy.",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 52
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "114a8f69_fb4d8cf2",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 1170070
      },
      "writtenOn": "2024-02-09T17:12:14Z",
      "side": 1,
      "message": "Thanks so much for the feedback! So I was working with Yisroel on this, and basically he was getting a `SELinux denied` SecurityException when attempting to connect to the service until this change. This was the denial:\n\n```\nSELinux: avc:  denied  { add } for pid\u003d1711 uid\u003d1000 name\u003dprofiling_service scontext\u003du:r:system_server:s0 tcontext\u003du:object_r:default_android_service:s0 tclass\u003dservice_manager permissive\u003d0\n```\n\nwhich is why we thought that the `add_service` line would fix it.",
      "parentUuid": "c6d7e7fb_cdbc36ee",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 52
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce03ede9_71a88450",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T17:20:31Z",
      "side": 1,
      "message": "(Yisroel \u0026 I have been chatting offline about this too.)\n\nThat denial is because the service wasn\u0027t getting the right label (default_android_service is the default, and nothing is allowed to touch that, to force people to pick a specific label).\n\nThe add should be working fine with the CL in its current form, now it\u0027s in service_contexts.\n\nIt was more the fact that nothing (other than system server itself) has access to find the service that struck me as odd. Adding app_api_service would fix that, depending on exactly how this is intended to be used.",
      "parentUuid": "114a8f69_fb4d8cf2",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 9,
        "endChar": 52
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "00477c03_33700b8f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 3
      },
      "lineNbr": 0,
      "author": {
        "id": 1170070
      },
      "writtenOn": "2024-02-09T03:43:30Z",
      "side": 1,
      "message": "Hmm, I\u0027m definitely confused by the selinux issues raised by presubmit:\n- two new untracked selinux denials at boot, which seem unrelated to these changes\n- a neverallow check that failed at system/sepolicy/public/domain.te:350, which is: \n```\n# All ioctls on file-like objects (except chr_file and blk_file) and\n# sockets must be restricted to an allowlist.\nneverallowxperm * *:{ dir notdevfile_class_set socket_class_set blk_file } ioctl { 0 };\n```\n\nNeither seem to be related to this change, but I\u0027m not sure what I\u0027m missing. Alan, do you know why these would come up from this change?",
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "765af083_82bf3bfa",
        "filename": "build/soong/service_fuzzer_bindings.go",
        "patchSetId": 3
      },
      "lineNbr": 384,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T10:35:26Z",
      "side": 1,
      "message": "The service is implemented in Java?",
      "range": {
        "startLine": 384,
        "startChar": 34,
        "endLine": 384,
        "endChar": 53
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a4cd299_fba4867a",
        "filename": "build/soong/service_fuzzer_bindings.go",
        "patchSetId": 3
      },
      "lineNbr": 384,
      "author": {
        "id": 1170070
      },
      "writtenOn": "2024-02-09T17:12:14Z",
      "side": 1,
      "message": "Yes.",
      "parentUuid": "765af083_82bf3bfa",
      "range": {
        "startLine": 384,
        "startChar": 34,
        "endLine": 384,
        "endChar": 53
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "0c690326_00fe40af",
        "filename": "build/soong/service_fuzzer_bindings.go",
        "patchSetId": 3
      },
      "lineNbr": 384,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T17:20:31Z",
      "side": 1,
      "message": "Acknowledged",
      "parentUuid": "2a4cd299_fba4867a",
      "range": {
        "startLine": 384,
        "startChar": 34,
        "endLine": 384,
        "endChar": 53
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "682f4dd8_cd096b05",
        "filename": "private/profiling_service.te",
        "patchSetId": 3
      },
      "lineNbr": 3,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T10:35:26Z",
      "side": 1,
      "message": "Rather than doing this explicitly, you should add the \"system_server_service\" attribute in your type declaration.\n\nAnd then you don\u0027t need this file at all.",
      "range": {
        "startLine": 2,
        "startChar": 0,
        "endLine": 3,
        "endChar": 46
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c8e7fa56_ed25ed27",
        "filename": "private/profiling_service.te",
        "patchSetId": 3
      },
      "lineNbr": 3,
      "author": {
        "id": 1170070
      },
      "writtenOn": "2024-02-09T17:12:14Z",
      "side": 1,
      "message": "Oooh, thanks! Though I think the above question applies - maybe we will need it again if we have a separate domain?",
      "parentUuid": "682f4dd8_cd096b05",
      "range": {
        "startLine": 2,
        "startChar": 0,
        "endLine": 3,
        "endChar": 46
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a75621f7_a3180d07",
        "filename": "private/profiling_service.te",
        "patchSetId": 3
      },
      "lineNbr": 3,
      "author": {
        "id": 1060831
      },
      "writtenOn": "2024-02-09T17:20:31Z",
      "side": 1,
      "message": "If it isn\u0027t hosted in system server, then yes - you should then remove the system_server_service attribute, and add `add_service(foo, profiling_service)`.",
      "parentUuid": "c8e7fa56_ed25ed27",
      "range": {
        "startLine": 2,
        "startChar": 0,
        "endLine": 3,
        "endChar": 46
      },
      "revId": "2d5f0b8f3008557544dccaef2a86a0d61dc0b4d9",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}